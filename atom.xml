<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ZhangHy&#39;s Zone!</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://weibo.com/"/>
  <updated>2018-12-11T04:29:29.322Z</updated>
  <id>http://weibo.com/</id>
  
  <author>
    <name>ZhangHy</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>原生js实现拖拽功能</title>
    <link href="http://weibo.com/2018/12/11/%E5%8E%9F%E7%94%9Fjs%E5%AE%9E%E7%8E%B0%E6%8B%96%E6%8B%BD%E5%8A%9F%E8%83%BD/"/>
    <id>http://weibo.com/2018/12/11/原生js实现拖拽功能/</id>
    <published>2018-12-11T04:17:52.000Z</published>
    <updated>2018-12-11T04:29:29.322Z</updated>
    
    <content type="html"><![CDATA[<p>如果要设置物体拖拽，那么必须使用三个事件，并且这三个事件的使用顺序不能颠倒。<br>onmousedown：鼠标按下事件<br>onmousemove：鼠标移动事件<br>onmouseup：鼠标抬起事件<br>拖拽的基本原理:<br>鼠标左键按下的状态下,根据鼠标的移动来移动被拖拽的元素。鼠标的移动也就是x、y坐标的变化;元素的移动就是style.position的 top和left的改变。<br><a id="more"></a><br>基本思路：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">拖拽状态 = 0鼠标在元素上按下的时候&#123;    </div><div class="line">    拖拽状态 = 1    </div><div class="line">    记录下鼠标的x和y坐标    </div><div class="line">    记录下元素的x和y坐标    </div><div class="line">&#125;</div><div class="line">鼠标在元素上移动的时候&#123;    </div><div class="line">    如果拖拽状态是0就什么也不做。    </div><div class="line">    如果拖拽状态是1，那么    </div><div class="line">    元素y = 现在鼠标y - 原来鼠标y + 原来元素y    </div><div class="line">    元素x = 现在鼠标x - 原来鼠标x + 原来元素x    </div><div class="line">&#125;     </div><div class="line">鼠标在任何时候放开的时候&#123;    </div><div class="line">    拖拽状态 = 0    </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="HTML代码"><a href="#HTML代码" class="headerlink" title="HTML代码"></a>HTML代码</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;div class=<span class="string">"calculator"</span> id=<span class="string">"drag"</span>&gt;**********&lt;/div&gt;</div></pre></td></tr></table></figure>
<h4 id="CSS代码"><a href="#CSS代码" class="headerlink" title="CSS代码"></a>CSS代码</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">.calculator &#123;</div><div class="line">    position: absolute; /*设置绝对定位，脱离文档流，便于拖拽*/</div><div class="line">    display: block;</div><div class="line">    width: 218px;</div><div class="line">    height: 280px;</div><div class="line">    cursor: move;   /*鼠标呈拖拽状*/</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="JS代码"><a href="#JS代码" class="headerlink" title="JS代码"></a>JS代码</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">window.onload = <span class="function"><span class="title">function</span></span>() &#123;</div><div class="line">    //拖拽功能(主要是触发三个事件：onmousedown\onmousemove\onmouseup)</div><div class="line">    var drag = document.getElementById(<span class="string">'drag'</span>);</div><div class="line"> </div><div class="line">    //点击某物体时，用drag对象即可，move和up是全局区域，也就是整个文档通用，应该使用document对象而不是drag对象(否则，采用drag对象时物体只能往右方或下方移动)</div><div class="line">    drag.onmousedown = <span class="keyword">function</span>(e) &#123;</div><div class="line">        var e = e || window.event; //兼容ie浏览器</div><div class="line">        var diffX = e.clientX - drag.offsetLeft; //鼠标点击物体那一刻相对于物体左侧边框的距离=点击时的位置相对于浏览器最左边的距离-物体左边框相对于浏览器最左边的距离</div><div class="line">        var diffY = e.clientY - drag.offsetTop;</div><div class="line"> </div><div class="line">        /*低版本ie bug:物体被拖出浏览器可是窗口外部时，还会出现滚动条，</div><div class="line">            解决方法是采用ie浏览器独有的2个方法setCapture()\releaseCapture(),这两个方法，</div><div class="line">            可以让鼠标滑动到浏览器外部也可以捕获到事件，而我们的bug就是当鼠标移出浏览器的时候，</div><div class="line">            限制超过的功能就失效了。用这个方法，即可解决这个问题。注：这两个方法用于onmousedown和onmouseup中*/</div><div class="line">            <span class="keyword">if</span>(typeof drag.setCapture!=<span class="string">'undefined'</span>)&#123;</div><div class="line">                drag.setCapture();</div><div class="line">            &#125;</div><div class="line"> </div><div class="line">        document.onmousemove = <span class="keyword">function</span>(e) &#123;</div><div class="line">            var e = e || window.event; //兼容ie浏览器</div><div class="line">            var left=e.clientX-diffX;</div><div class="line">            var top=e.clientY-diffY;</div><div class="line"> </div><div class="line">            //控制拖拽物体的范围只能在浏览器视窗内，不允许出现滚动条</div><div class="line">            <span class="keyword">if</span>(left&lt;0)&#123;</div><div class="line">                left=0;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(left &gt;window.innerWidth-drag.offsetWidth)&#123;</div><div class="line">                left = window.innerWidth-drag.offsetWidth;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(top&lt;0)&#123;</div><div class="line">                top=0;</div><div class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(top &gt;window.innerHeight-drag.offsetHeight)&#123;</div><div class="line">                top = window.innerHeight-drag.offsetHeight;</div><div class="line">            &#125;</div><div class="line"> </div><div class="line">            //移动时重新得到物体的距离，解决拖动时出现晃动的现象</div><div class="line">            drag.style.left = left+ <span class="string">'px'</span>;</div><div class="line">            drag.style.top = top + <span class="string">'px'</span>;</div><div class="line">        &#125;;</div><div class="line">        document.onmouseup = <span class="keyword">function</span>(e) &#123; //当鼠标弹起来的时候不再移动</div><div class="line">            this.onmousemove = null;</div><div class="line">            this.onmouseup = null; //预防鼠标弹起来后还会循环（即预防鼠标放上去的时候还会移动）</div><div class="line"> </div><div class="line">            //修复低版本ie bug</div><div class="line">            <span class="keyword">if</span>(typeof drag.releaseCapture!=<span class="string">'undefined'</span>)&#123;</div><div class="line">                drag.releaseCapture();</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">    &#125;;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;如果要设置物体拖拽，那么必须使用三个事件，并且这三个事件的使用顺序不能颠倒。&lt;br&gt;onmousedown：鼠标按下事件&lt;br&gt;onmousemove：鼠标移动事件&lt;br&gt;onmouseup：鼠标抬起事件&lt;br&gt;拖拽的基本原理:&lt;br&gt;鼠标左键按下的状态下,根据鼠标的移动来移动被拖拽的元素。鼠标的移动也就是x、y坐标的变化;元素的移动就是style.position的 top和left的改变。&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://weibo.com/categories/JavaScript/"/>
    
    
  </entry>
  
  <entry>
    <title>JavaScript内存泄漏</title>
    <link href="http://weibo.com/2018/12/11/JavaScript%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F/"/>
    <id>http://weibo.com/2018/12/11/JavaScript内存泄漏/</id>
    <published>2018-12-11T02:35:45.000Z</published>
    <updated>2018-12-11T04:41:31.091Z</updated>
    
    <content type="html"><![CDATA[<h2 id="内存泄漏"><a href="#内存泄漏" class="headerlink" title="内存泄漏"></a>内存泄漏</h2><p>内存泄漏是导致迟缓，崩溃，高延迟的根本原因，甚至会导致其他应用问题。<br>程序运行需要内存，只要程序提出要求，操作系统或者程序运行时（runtime）就必须供给内存。<br>对于持续运行的服务进程（daemon），必须要及时释放掉不用的内存，否则，内存占用越来越高，会影响系统性能，甚至导致进程崩溃。<br>不再使用到的内存，没有及时释放，就叫做内存泄漏。<br><a id="more"></a></p>
<h2 id="JavaScript垃圾回收机制"><a href="#JavaScript垃圾回收机制" class="headerlink" title="JavaScript垃圾回收机制"></a>JavaScript垃圾回收机制</h2><p>垃圾回收机制通过”引用计数（reference counting）”的方式来判定是否需要进行内存释放。<br>语言引擎有一张”引用表”，保存了内存里面所有的资源（通常是各种值）的引用次数。如果一个值的引用次数是”0”，就表示这个值不再用到了，因此可以将这块内存释放。<br><img src="/2018/12/11/JavaScript内存泄漏/root.png" alt=""><br>上图中，打了红叉的两个值（即垃圾），没有任何引用，所以这块内存可以被释放。<br>如果一个值不再需要了，引用数却不为”0”，垃圾回收机制无法释放这块内存，从而导致内存泄漏。<br>大多数垃圾回收机制使用称为标记和扫描的算法(Mark-and-sweep)。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">1、垃圾回收机制构建一个&quot;根&quot;列表。根通常是在代码中保存引用的全局变量。在JavaScript中，&quot;window&quot;对象是可以充当根的全局变量的示例。窗口对象总是存在的，所以垃圾回收机制可以考虑它和它的所有的子节点总是存在（即不是垃圾）。</div><div class="line">2、所有根被检查并标记为活动（即不是垃圾）。所有子节点也被递归检查。从根可以到达的一切都不被认为是垃圾。</div><div class="line">3、所有未标记为活动的内存块现在可以被认为是垃圾(如上图中打了红叉的地方)。回收机制现在可以释放该内存并将其返回到操作系统。</div></pre></td></tr></table></figure></p>
<h2 id="解除引用，如"><a href="#解除引用，如" class="headerlink" title="解除引用，如"></a>解除引用，如</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">const arr = [1, 2, 3, 4];</div><div class="line">console.log(<span class="string">'hello world'</span>);</div></pre></td></tr></table></figure>
<p>上面代码中，数组[1, 2, 3, 4]是一个值，会占用内存。变量arr是仅有的对这个值的引用，因此引用次数为”1”。尽管后面的代码没有用到arr，它还是会持续占用内存。</p>
<p>如果增加一行代码，解除arr对[1, 2, 3, 4]引用，这块内存就可以被垃圾回收机制释放了。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">let</span> arr = [1, 2, 3, 4];</div><div class="line">console.log(<span class="string">'hello world'</span>);</div><div class="line">arr = null;</div></pre></td></tr></table></figure></p>
<p>上面代码中，arr重置为null，就解除了对[1, 2, 3, 4]的引用，引用次数变成了”0”，内存就可以释放出来了。</p>
<p>如果占用内存的值不再用到，就必须手动解除引用。</p>
<h2 id="四种常见的JavaScript-内存泄漏"><a href="#四种常见的JavaScript-内存泄漏" class="headerlink" title="四种常见的JavaScript 内存泄漏"></a>四种常见的JavaScript 内存泄漏</h2><h4 id="意外的全局变量"><a href="#意外的全局变量" class="headerlink" title="意外的全局变量"></a>意外的全局变量</h4><p>JavaScript允许的方式之一是处理未声明的变量：对未声明的变量的引用在全局对象内创建一个新的变量。 在浏览器的情况下，全局对象是窗口。<br>如：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">function</span> foo(arg) &#123;</div><div class="line">    bar = <span class="string">"this is a hidden global variable"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>事实上：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">function</span> foo(arg) &#123;</div><div class="line">    window.bar = <span class="string">"this is an explicit global variable"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>如果bar应该只在foo函数的范围内保存对变量的引用，并且忘记使用var来声明它，那么会创建一个意外的全局变量。 建偶然的全局变量的另一种方式是通过下面这样：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">function</span> <span class="function"><span class="title">foo</span></span>() &#123;</div><div class="line">    this.variable = <span class="string">"potential accidental global"</span>;</div><div class="line">&#125;</div><div class="line">// Foo called on its own, this points to the global object (window)</div><div class="line">// rather than being undefined.</div><div class="line">foo();</div></pre></td></tr></table></figure></p>
<p>为了防止这些错误发生，在JavaScript文件的开头添加’use strict’。 这使得能够更严格地解析JavaScript以防止意外的全局变量。</p>
<h4 id="被遗忘的计时器或回调函数"><a href="#被遗忘的计时器或回调函数" class="headerlink" title="被遗忘的计时器或回调函数"></a>被遗忘的计时器或回调函数</h4><p>如：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var someResource = getData();</div><div class="line">setInterval(<span class="function"><span class="title">function</span></span>() &#123;</div><div class="line">  var node = document.getElementById(<span class="string">'Node'</span>);</div><div class="line">  <span class="keyword">if</span>(node) &#123;</div><div class="line">    // Do stuff with node and someResource.</div><div class="line">    node.innerHTML = JSON.stringify(someResource));</div><div class="line">  &#125;</div><div class="line">&#125;, 1000);</div></pre></td></tr></table></figure></p>
<p>上面示例挂起计时器可能发生的情况：引用不再需要的节点或数据的计时器。 由节点表示的对象可以在将来被移除，使得区间处理器内部的整个块不需要了。 但是，处理程序（因为时间间隔仍处于活动状态）无法回收（需要停止时间间隔才能发生）。 如果无法回收间隔处理程序，则也无法回收其依赖项。 这意味着someResource，它可能存储大小的数据，也不能被回收。</p>
<p>一旦观察到的对象变得不可达，即使没有明确删除监听器，大多数浏览器也可以回收观察者处理程序。 然而，在对象被处理之前显式地删除这些观察者仍是有必要的。 如：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">var element = document.getElementById(<span class="string">'button'</span>);</div><div class="line"><span class="keyword">function</span> onClick(event) &#123;</div><div class="line">  element.innerHtml = <span class="string">'text'</span>;</div><div class="line">&#125;</div><div class="line">element.addEventListener(<span class="string">'click'</span>, onClick);</div><div class="line">// Do stuff</div><div class="line">element.removeEventListener(<span class="string">'click'</span>, onClick);</div><div class="line">element.parentNode.removeChild(element);</div><div class="line">// Now when element goes out of scope,</div><div class="line">// both element and onClick will be collected even <span class="keyword">in</span> old browsers that don<span class="string">'t</span></div><div class="line"><span class="string">// handle cycles well.</span></div></pre></td></tr></table></figure></p>
<h4 id="脱离-DOM-的引用"><a href="#脱离-DOM-的引用" class="headerlink" title="脱离 DOM 的引用"></a>脱离 DOM 的引用</h4><p>有时，将DOM节点存储在数据结构中可能很有用。<br>假设要快速更新表中多行的内容。 在字典或数组中存储对每个DOM行的引用可能是有意义的。<br>当发生这种情况时，会保留对同一个DOM元素的两个引用：一个在DOM树中，另一个在字典中。<br>如果在将来的某个时候，您决定删除这些行，则需要使这两个引用不可访问。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">var elements = &#123;</div><div class="line">    button: document.getElementById(<span class="string">'button'</span>),</div><div class="line">    image: document.getElementById(<span class="string">'image'</span>),</div><div class="line">    text: document.getElementById(<span class="string">'text'</span>)</div><div class="line">&#125;;</div><div class="line"><span class="keyword">function</span> <span class="function"><span class="title">doStuff</span></span>() &#123;</div><div class="line">    image.src = <span class="string">'http://some.url/image'</span>;</div><div class="line">    button.click();</div><div class="line">    console.log(text.innerHTML);</div><div class="line">    // Much more logic</div><div class="line">&#125;</div><div class="line"><span class="keyword">function</span> <span class="function"><span class="title">removeButton</span></span>() &#123;</div><div class="line">    // The button is a direct child of body.</div><div class="line">    document.body.removeChild(document.getElementById(<span class="string">'button'</span>));</div><div class="line">    // At this point, we still have a reference to <span class="comment">#button in the global</span></div><div class="line">    // elements dictionary. In other words, the button element is still <span class="keyword">in</span></div><div class="line">    // memory and cannot be collected by the GC.</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h4><p>JavaScript开发的一个关键方面是闭包：从父作用域捕获变量的匿名函数。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">var theThing = null;</div><div class="line">var replaceThing = <span class="function"><span class="title">function</span></span> () &#123;</div><div class="line">    var originalThing = theThing;</div><div class="line">    var unused = <span class="function"><span class="title">function</span></span> () &#123;</div><div class="line">        <span class="keyword">if</span> (originalThing)</div><div class="line">            console.log(<span class="string">"hi"</span>);</div><div class="line">        &#125;;</div><div class="line">        theThing = &#123;</div><div class="line">            longStr: new Array(1000000).join(<span class="string">'*'</span>),</div><div class="line">            someMethod: <span class="function"><span class="title">function</span></span> () &#123;</div><div class="line">                console.log(someMessage);</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">    &#125;;</div><div class="line">setInterval(replaceThing, 1000);</div></pre></td></tr></table></figure></p>
<p>上面代码片段主要做了以下工作：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">每次replaceThing被调用，theThing获取一个新的对象，其中包含一个大数组和一个新的闭包（someMethod）。同时，unused变量保持一个闭包，该闭包具有对originalThing的引用（来自之前对replaceThing的调用的Thing）。已经有点混乱了，是吗？重要的是，一旦为同一父作用域中的闭包创建了作用域，则该作用域是共享的。在这种情况下，为闭包someMethod创建的作用域由unused共享。unused的引用了originalThing。即使unused未使用，可以通过theThing使用someMethod。由于someMethod与unused共享闭包范围，即使未使用，它对originalThing的引用强制它保持活动（防止其收集）。当此代码段重复运行时，可以观察到内存使用量的稳定增加。实质上，创建一个闭包的链接列表（其根以theThing变量的形式），并且这些闭包的范围中的每一个都包含对大数组的间接引用，导致相当大的泄漏。</div></pre></td></tr></table></figure></p>
<h2 id="内存泄漏的识别方法"><a href="#内存泄漏的识别方法" class="headerlink" title="内存泄漏的识别方法"></a>内存泄漏的识别方法</h2><h4 id="Chrome-浏览器查看内存占用"><a href="#Chrome-浏览器查看内存占用" class="headerlink" title="Chrome 浏览器查看内存占用"></a>Chrome 浏览器查看内存占用</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">1、打开开发者工具，选择 Timeline 面板</div><div class="line">2、在顶部的Capture字段里面勾选 Memory</div><div class="line">3、点击左上角的录制按钮。</div><div class="line">4、在页面上进行各种操作，模拟用户的使用情况。</div><div class="line">5、一段时间后，点击对话框的 stop 按钮，面板上就会显示这段时间的内存占用情况</div></pre></td></tr></table></figure>
<p>如果内存占用基本平稳，接近水平，就说明不存在内存泄漏。反之，就是内存泄漏了。</p>
<h4 id="命令行可以使用-Node-提供的process-memoryUsage方法"><a href="#命令行可以使用-Node-提供的process-memoryUsage方法" class="headerlink" title="命令行可以使用 Node 提供的process.memoryUsage方法"></a>命令行可以使用 Node 提供的process.memoryUsage方法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">console.log(process.memoryUsage());</div><div class="line">// &#123; rss: 27709440,</div><div class="line">//  heapTotal: 5685248,</div><div class="line">//  heapUsed: 3449392,</div><div class="line">//  external: 8772 &#125;</div></pre></td></tr></table></figure>
<p>process.memoryUsage返回一个对象，包含了 Node 进程的内存占用信息。该对象包含四个字段，单位是字节。<br>rss（resident set size）：所有内存占用，包括指令区和堆栈。<br>heapTotal：”堆”占用的内存，包括用到的和没用到的。<br>heapUsed：用到的堆的部分。<br>external： V8 引擎内部的 C++ 对象占用的内存。<br>判断内存泄漏，以heapUsed字段为准。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;内存泄漏&quot;&gt;&lt;a href=&quot;#内存泄漏&quot; class=&quot;headerlink&quot; title=&quot;内存泄漏&quot;&gt;&lt;/a&gt;内存泄漏&lt;/h2&gt;&lt;p&gt;内存泄漏是导致迟缓，崩溃，高延迟的根本原因，甚至会导致其他应用问题。&lt;br&gt;程序运行需要内存，只要程序提出要求，操作系统或者程序运行时（runtime）就必须供给内存。&lt;br&gt;对于持续运行的服务进程（daemon），必须要及时释放掉不用的内存，否则，内存占用越来越高，会影响系统性能，甚至导致进程崩溃。&lt;br&gt;不再使用到的内存，没有及时释放，就叫做内存泄漏。&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://weibo.com/categories/JavaScript/"/>
    
    
  </entry>
  
  <entry>
    <title>js中的伪数组并转换为标准数组</title>
    <link href="http://weibo.com/2018/12/10/js%E4%B8%AD%E7%9A%84%E4%BC%AA%E6%95%B0%E7%BB%84%E5%B9%B6%E8%BD%AC%E6%8D%A2%E4%B8%BA%E6%A0%87%E5%87%86%E6%95%B0%E7%BB%84/"/>
    <id>http://weibo.com/2018/12/10/js中的伪数组并转换为标准数组/</id>
    <published>2018-12-10T09:16:54.000Z</published>
    <updated>2018-12-10T09:41:10.138Z</updated>
    
    <content type="html"><![CDATA[<p>突然想起一道面试题，什么是JavaScript伪数组，怎么将伪数组转换为标准数组。</p>
<h2 id="伪数组（类数组）："><a href="#伪数组（类数组）：" class="headerlink" title="伪数组（类数组）："></a>伪数组（类数组）：</h2><p>1、无法直接调用数组方法或期望length属性有什么特殊的行为，不具有数组的push,pop等方法，但仍可以对真正数组遍历方法来遍历它们。<br>2、典型的是函数的argument参数，还有像调用getElementsByTagName,document.childNodes之类的,它们都返回NodeList对象都属于伪数组。<br>3、可以使用Array.prototype.slice.call(fakeArray)将数组转化为真正的Array对象。<br><a id="more"></a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">function</span> <span class="function"><span class="title">log</span></span>()&#123;</div><div class="line">    var args = Array.prototype.slice.call(arguments); </div><div class="line">    //为了使用unshift数组方法，将argument转化为真正的数组</div><div class="line">    </div><div class="line">    args.unshift(<span class="string">'(app)'</span>);</div><div class="line">    console.log.apply(console, args);</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>这里把符合以下条件的对象称为伪数组(fakeArray)：<br>1、具有length属性<br>2、按索引方式存储数据<br>3、不具有数组的push,pop等方法<br>如:<br>1、function内的arguments<br>2、通过document.forms，Form.elements，Select.options，document.getElementsByName()，document.getElementsByTagName() ，childNodes/children 等方式获取的集合（HTMLCollection，NodeList）等<br>3、特殊写法的对象 ，如：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var obj=&#123;&#125;;</div><div class="line">obj[0] = <span class="string">"一"</span>;</div><div class="line">obj[1] = <span class="string">"二"</span>;</div><div class="line">obj[2] = <span class="string">"三"</span>;</div><div class="line">obj.length = 3;</div></pre></td></tr></table></figure></p>
<p>它们不具有数组的一些方法如push, pop, shift, join等。有时候需要将这些伪数组转成真正的数组，这样可以使用push, pop等方法。以下是工具函数makeArray:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">function</span> makeArray(obj)&#123;</div><div class="line">    var rs=[],len=obj.length;</div><div class="line">    try&#123;</div><div class="line">        rs = [].slice.call(obj,0);</div><div class="line">    &#125;catch(e)&#123; //<span class="keyword">for</span> IE</div><div class="line">        <span class="keyword">for</span>(var i=0;j=obj[i++];)&#123;</div><div class="line">            rs.push(j);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">return</span> rs;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>以下分别测试以上三种伪数组：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">//定义一个函数fun,内部使用makeArray将其arguments转换成数组</div><div class="line"><span class="keyword">function</span> <span class="function"><span class="title">fun</span></span>()&#123;</div><div class="line">    var ary = makeArray(arguments);</div><div class="line">    alert(ary.constructor );</div><div class="line">&#125;</div><div class="line">//调用</div><div class="line">fun(3,5);</div><div class="line">//假设页面上有多个段落元素p</div><div class="line">var els = document.getElementsByTagName(<span class="string">"p"</span>);</div><div class="line">var ary1 = makeArray(els);</div><div class="line">alert(ary1.constructor);</div><div class="line">//特殊的js对象（如jquery对象）</div><div class="line">var obj=&#123;&#125;;</div><div class="line">obj[0] = <span class="string">"一"</span>;</div><div class="line">obj[1] = <span class="string">"二"</span>;</div><div class="line">obj[2] = <span class="string">"三"</span>;</div><div class="line">obj.length = 3;</div><div class="line"></div><div class="line">var ary2 = makeArray(obj);</div><div class="line">alert(ary2.constructor);</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;突然想起一道面试题，什么是JavaScript伪数组，怎么将伪数组转换为标准数组。&lt;/p&gt;
&lt;h2 id=&quot;伪数组（类数组）：&quot;&gt;&lt;a href=&quot;#伪数组（类数组）：&quot; class=&quot;headerlink&quot; title=&quot;伪数组（类数组）：&quot;&gt;&lt;/a&gt;伪数组（类数组）：&lt;/h2&gt;&lt;p&gt;1、无法直接调用数组方法或期望length属性有什么特殊的行为，不具有数组的push,pop等方法，但仍可以对真正数组遍历方法来遍历它们。&lt;br&gt;2、典型的是函数的argument参数，还有像调用getElementsByTagName,document.childNodes之类的,它们都返回NodeList对象都属于伪数组。&lt;br&gt;3、可以使用Array.prototype.slice.call(fakeArray)将数组转化为真正的Array对象。&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://weibo.com/categories/JavaScript/"/>
    
    
  </entry>
  
  <entry>
    <title>15款Chrome插件推荐</title>
    <link href="http://weibo.com/2018/12/10/15%E6%AC%BEChrome%E6%8F%92%E4%BB%B6%E6%8E%A8%E8%8D%90/"/>
    <id>http://weibo.com/2018/12/10/15款Chrome插件推荐/</id>
    <published>2018-12-10T09:08:52.000Z</published>
    <updated>2018-12-10T09:43:20.315Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://mp.weixin.qq.com/s/uaQFaaU54sx98BcyI2jskA?" target="_blank" rel="external">原文链接</a><br>相信很多人都在使用 Chrome 浏览器，其流畅的浏览体验得到了不少用户的偏爱，但流畅只是一方面， Chrome 最大的优势还是其支持众多强大好用的扩展程序（Extensions）。</p>
<h2 id="Data-Saver：为你省下一些流量"><a href="#Data-Saver：为你省下一些流量" class="headerlink" title="Data Saver：为你省下一些流量"></a>Data Saver：为你省下一些流量</h2><p>Google 官方推出的省流量扩展程序，启用之后 Chrome 会自动压缩被访问网页的数据来节省流量，但不包括 SSL 加密协议的网页，这个版本还处在测试阶段。另外，iOS 和 Android 版本的 Chrome 可以在设置中启用。<br>在 Chrome Web Store 下载 Data Saver (Beta)。<br><a id="more"></a></p>
<h2 id="Lucidchart-Diagrams-Desktop：在线绘制多种图表"><a href="#Lucidchart-Diagrams-Desktop：在线绘制多种图表" class="headerlink" title="Lucidchart Diagrams - Desktop：在线绘制多种图表"></a>Lucidchart Diagrams - Desktop：在线绘制多种图表</h2><p>这个扩展程序是一款多功能绘制程序，支持绘制流程图，思维导图，版面设计等，并且有在线和离线两种模式，可谓功能强大。<br>在 Chrome Web Store 下载 Lucidchart Diagrams - Desktop</p>
<h2 id="Trackr：追踪你的上网习惯"><a href="#Trackr：追踪你的上网习惯" class="headerlink" title="Trackr：追踪你的上网习惯"></a>Trackr：追踪你的上网习惯</h2><p>这个扩展程序做的事情就是记录你使用 Chrome 上网的习惯，包括上了哪些网站、每个网站呆多长时间，并且还用图表的形式反馈出来，总之装了这个扩展程序就不要上奇奇怪怪的网站了。<br>在 Chrome Web Store 下载 Trackr。</p>
<h2 id="Reader-View：Chrome-也有-Safari-的阅读模式"><a href="#Reader-View：Chrome-也有-Safari-的阅读模式" class="headerlink" title="Reader View：Chrome 也有 Safari 的阅读模式"></a>Reader View：Chrome 也有 Safari 的阅读模式</h2><p>将网页转换成 Safari 阅读模式的样式，让你更方便舒适的阅读网页文字，当你访问文章网页的时候，扩展程序的按钮会显示在地址栏末端，点击就能轻松享受更好的阅读模式。<br>在 Chrome Web Store 下载 Reader View。</p>
<h2 id="Dropbox-for-Gmail：更方便的使用-Dropbox"><a href="#Dropbox-for-Gmail：更方便的使用-Dropbox" class="headerlink" title="Dropbox for Gmail：更方便的使用 Dropbox"></a>Dropbox for Gmail：更方便的使用 Dropbox</h2><p>Dropbox 的 Chrome 扩展程序，能够让你快速打开 Dropbox 上最近访问的文件，或者快速分享 Dropbox 上的文件给朋友，对于使用 Dropbox 的朋友来说会方便很多。<br>在 Chrome Web Store 下载 Dropbox for Gmail。</p>
<h2 id="DrumUp：个性化的浏览推荐"><a href="#DrumUp：个性化的浏览推荐" class="headerlink" title="DrumUp：个性化的浏览推荐"></a>DrumUp：个性化的浏览推荐</h2><p>当你打开一个网页的时候，为您推荐与现在浏览的网页内容相似或者相关的内容，对于英文的支持比较好，每天阅读很多的人能找到很多关联的感兴趣内容。<br>在 Chrome Web Store 下载 DrumUp。</p>
<h2 id="Highly-Highlighter：网页浏览也玩社交分享"><a href="#Highly-Highlighter：网页浏览也玩社交分享" class="headerlink" title="Highly Highlighter：网页浏览也玩社交分享"></a>Highly Highlighter：网页浏览也玩社交分享</h2><p>这个扩展程序允许你高亮自己所浏览网页的重要部分，保存到本地或者分享给自己的朋友，你也可以在 Highly 上关注自己的朋友，并获得它高亮文段的推送。<br>在 Chrome Web Store 下载 Highly Highlighter。</p>
<h2 id="Mainichi：学习日语，每页一词"><a href="#Mainichi：学习日语，每页一词" class="headerlink" title="Mainichi：学习日语，每页一词"></a>Mainichi：学习日语，每页一词</h2><p>学习日语的新方式，每当你打开一个新标签页对会显示一个日文单词，并且配有一张简洁的图片、假名及其读音，不知道有多少朋友在学习日语呢？<br>在 Chrome Web Store 下载 Mainichi。</p>
<h2 id="New-Tab-Startup-Quotes：学习成功人士的格言"><a href="#New-Tab-Startup-Quotes：学习成功人士的格言" class="headerlink" title="New Tab Startup Quotes：学习成功人士的格言"></a>New Tab Startup Quotes：学习成功人士的格言</h2><p>想学习成功人士的精神和智慧，这个扩展程序可以帮到你，每当你打开一个标签页，它都会显示一位成功人士的格言，不得不说熬得一锅好鸡汤。<br>在 Chrome Web Store 下载 New Tab Startup Quotes。</p>
<h2 id="Delight-for-Chrome"><a href="#Delight-for-Chrome" class="headerlink" title="Delight for Chrome"></a>Delight for Chrome</h2><p>每次打开一个新标签页都会显示一段绝美的延时摄影视频，同时还会显示天气等信息，效果非常棒，而且显示的自然风景每次都不一样。<br>在 Chrome Web Store 下载 Delight for Chrome。</p>
<h2 id="Google-Art-Project"><a href="#Google-Art-Project" class="headerlink" title="Google Art Project"></a>Google Art Project</h2><p>每次打开一个新标签页都会显示一张来自 Google Cultural Institute 的艺术图片，可能是梵高或者莫奈的画作，可能是自然风景的图片，甚至是世界各地的街头涂鸦，每次都不一样。<br>在 Chrome Web Store 下载 Google Art Project。</p>
<h2 id="Unsplash-Instant"><a href="#Unsplash-Instant" class="headerlink" title="Unsplash Instant"></a>Unsplash Instant</h2><p>每次打开一个新标签页都会显示一张来自 Unsplash 的摄影作品，全高清的分辨率和专业的摄影元素，Unsplash 的作品都是满满的文艺范儿，非常适合文艺青年。<br>在 Chrome Web Store 下载 Unsplash Instant。</p>
<h2 id="Flickr-Tab"><a href="#Flickr-Tab" class="headerlink" title="Flickr Tab"></a>Flickr Tab</h2><p>每次打开一个新标签页都会显示一张来自 Flickr 的摄影作品，Flickr 是世界上最大的图片社区之一，庞大的用户群让它能够时刻保持拥有高水平的摄影作品，一定有你喜欢的类型。<br>在 Chrome Web Store 下载 Flickr Tab。</p>
<h2 id="Wandertab"><a href="#Wandertab" class="headerlink" title="Wandertab"></a>Wandertab</h2><p>每次打开一个新标签页都会显示一张来自世界各地经典的摄影作品，让你足不出户就可以浏览世界各地的名胜风景，这些摄影作品的水品都颇高，当做壁纸都不为过。<br>在 Chrome Web Store 下载 Wandertab。</p>
<h2 id="Urthecast-Imagery"><a href="#Urthecast-Imagery" class="headerlink" title="Urthecast Imagery"></a>Urthecast Imagery</h2><p>每次打开一个新标签页都会显示一张来自卫星拍摄的地质地貌图片，地球的纹理错综复杂，每一张照片都是一副艺术品，是追求逼格的人士的不二选择。<br>在 Chrome Web Store 下载 Urthecast Imagery。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s/uaQFaaU54sx98BcyI2jskA?&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;原文链接&lt;/a&gt;&lt;br&gt;相信很多人都在使用 Chrome 浏览器，其流畅的浏览体验得到了不少用户的偏爱，但流畅只是一方面， Chrome 最大的优势还是其支持众多强大好用的扩展程序（Extensions）。&lt;/p&gt;
&lt;h2 id=&quot;Data-Saver：为你省下一些流量&quot;&gt;&lt;a href=&quot;#Data-Saver：为你省下一些流量&quot; class=&quot;headerlink&quot; title=&quot;Data Saver：为你省下一些流量&quot;&gt;&lt;/a&gt;Data Saver：为你省下一些流量&lt;/h2&gt;&lt;p&gt;Google 官方推出的省流量扩展程序，启用之后 Chrome 会自动压缩被访问网页的数据来节省流量，但不包括 SSL 加密协议的网页，这个版本还处在测试阶段。另外，iOS 和 Android 版本的 Chrome 可以在设置中启用。&lt;br&gt;在 Chrome Web Store 下载 Data Saver (Beta)。&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Chrome" scheme="http://weibo.com/categories/Chrome/"/>
    
    
  </entry>
  
  <entry>
    <title>KVM虚拟化调整虚拟内存和CPU大小</title>
    <link href="http://weibo.com/2018/12/10/KVM%E8%99%9A%E6%8B%9F%E5%8C%96%E8%B0%83%E6%95%B4%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E5%92%8CCPU%E5%A4%A7%E5%B0%8F/"/>
    <id>http://weibo.com/2018/12/10/KVM虚拟化调整虚拟内存和CPU大小/</id>
    <published>2018-12-10T08:41:34.000Z</published>
    <updated>2018-12-10T09:02:18.994Z</updated>
    
    <content type="html"><![CDATA[<p>这篇本来应该上周五就写的，但是家里有事，今天补上。<br>周五开发的时候发现之前装的虚拟机，系统一跑起来dplane就挂了，然后排查原因，是因为装虚拟机的时候分配的内存不够用，于是想要使用KVM进行虚拟内存的调整，将内存从1Gb调整到2Gb，后来系统顺利跑起来了。<br>以下内容是总结之后的内容，包含工作需要以外的拓展内容：<br><a id="more"></a></p>
<h2 id="一、调小虚拟机内存"><a href="#一、调小虚拟机内存" class="headerlink" title="一、调小虚拟机内存"></a>一、调小虚拟机内存</h2><p>1、查看虚拟机内存大小,V1为我的虚拟机名称<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root@zhy:~<span class="comment"># virsh dominfo V1 | grep memory</span></div><div class="line">Max memory:     1048432 KiB</div><div class="line">Used memory:    1048432 KiB</div></pre></td></tr></table></figure></p>
<p>2.设置虚拟机内存大小为512MB<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">root@zhy:~<span class="comment">## virsh setmem V1 524288</span></div></pre></td></tr></table></figure></p>
<p>3.再次查看当前内存大小<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root@zhy:~<span class="comment"># virsh dominfo V1 | grep memory</span></div><div class="line">Max memory:     1048432 KiB</div><div class="line">Used memory:    524288 KiB</div></pre></td></tr></table></figure></p>
<h2 id="二、增大虚拟机内存、增加虚拟机CPU个数"><a href="#二、增大虚拟机内存、增加虚拟机CPU个数" class="headerlink" title="二、增大虚拟机内存、增加虚拟机CPU个数"></a>二、增大虚拟机内存、增加虚拟机CPU个数</h2><h3 id="增大虚拟机内存、增加虚拟机CPU个数需要首先关机虚拟机"><a href="#增大虚拟机内存、增加虚拟机CPU个数需要首先关机虚拟机" class="headerlink" title="增大虚拟机内存、增加虚拟机CPU个数需要首先关机虚拟机"></a>增大虚拟机内存、增加虚拟机CPU个数需要首先关机虚拟机</h3><p>1.关闭虚拟机<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">virsh shutdown V1</div></pre></td></tr></table></figure></p>
<p>2.编辑虚拟机配置文件<br>修改内存大小、vcpu个数<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">virsh edit V1</div><div class="line">......</div><div class="line">  &lt;memory unit=<span class="string">'KiB'</span>&gt;2146304&lt;/memory&gt;</div><div class="line">  &lt;currentMemory unit=<span class="string">'KiB'</span>&gt;2146304&lt;/currentMemory&gt;</div><div class="line">  &lt;vcpu placement=<span class="string">'static'</span>&gt;2&lt;/vcpu&gt;</div><div class="line">......</div></pre></td></tr></table></figure></p>
<p>3.从配置文件启动虚拟机<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">virsh create /etc/libvirt/qemu/V1.xml</div></pre></td></tr></table></figure></p>
<p>4.查看当前内存大小<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root@zhy:~<span class="comment"># virsh dominfo V1 | grep memory</span></div><div class="line">Max memory:     2146304 KiB</div><div class="line">Used memory:    524288 KiB</div></pre></td></tr></table></figure></p>
<p>5.设置虚拟机内存大小为2G<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">root@zhy:~<span class="comment"># virsh setmem V1 2146304</span></div></pre></td></tr></table></figure></p>
<p>6.验证<br>查看当前内存大小<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root@zhy:~<span class="comment"># virsh dominfo V1 | grep memory</span></div><div class="line">Max memory:     2146304 KiB</div><div class="line">Used memory:    2146304 KiB</div></pre></td></tr></table></figure></p>
<p>查看当前CPU个数<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">root@zhy:~<span class="comment"># virsh dominfo V1 | grep CPU</span></div><div class="line">CPU(s):         2</div><div class="line">CPU time:       15.0s</div></pre></td></tr></table></figure></p>
<h2 id="三、命令详单"><a href="#三、命令详单" class="headerlink" title="三、命令详单"></a>三、命令详单</h2><h3 id="root-zhy-virsh"><a href="#root-zhy-virsh" class="headerlink" title="root@zhy:~# virsh"></a>root@zhy:~# virsh</h3><p>virsh # help    打印帮助<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div></pre></td><td class="code"><pre><div class="line">attach-device   从一个XML文件附加装置</div><div class="line">attach-disk     附加磁盘设备</div><div class="line">attach-interface 获得网络界面</div><div class="line">autostart       自动开始一个域</div><div class="line">capabilities    性能</div><div class="line"><span class="built_in">cd</span>              change the current directory</div><div class="line">connect         连接（重新连接）到 hypervisor</div><div class="line">console         连接到客户会话</div><div class="line">cpu-baseline    compute baseline CPU</div><div class="line">cpu-compare     compare host CPU with a CPU described by an XML file</div><div class="line">create          从一个 XML 文件创建一个域</div><div class="line">start           开始一个（以前定义的）非活跃的域</div><div class="line">destroy         删除一个域</div><div class="line">detach-device   从一个 XML 文件分离设备</div><div class="line">detach-disk     分离磁盘设备</div><div class="line">detach-interface 分离网络界面</div><div class="line">define          从一个 XML 文件定义（但不开始）一个域</div><div class="line">domid           把一个域名或 UUID 转换为域 id</div><div class="line">domuuid         把一个域名或 id 转换为域 UUID</div><div class="line">dominfo         域信息</div><div class="line">domjobinfo      domain job information</div><div class="line">domjobabort     abort active domain job</div><div class="line">domname         将域 id 或 UUID 转换为域名</div><div class="line">domstate        域状态</div><div class="line">domblkstat      获得域设备块状态</div><div class="line">domifstat       获得域网络接口状态</div><div class="line">dommemstat      get memory statistics <span class="keyword">for</span> a domain</div><div class="line">domblkinfo      domain block device size information</div><div class="line">domxml-from-native Convert native config to domain XML</div><div class="line">domxml-to-native Convert domain XML to native config</div><div class="line">dumpxml         XML 中的域信息</div><div class="line">edit            编辑某个域的 XML 配置</div><div class="line">find-storage-pool-sources 发现潜在存储池源</div><div class="line">find-storage-pool-sources-as 找到潜在存储池源</div><div class="line">freecell        NUMA可用内存</div><div class="line">hostname        打印管理程序主机名</div><div class="line">list            列出域</div><div class="line">migrate         将域迁移到另一个主机中</div><div class="line">migrate-setmaxdowntime <span class="built_in">set</span> maximum tolerable downtime</div><div class="line">net-autostart   自动开始网络</div><div class="line">net-create      从一个 XML 文件创建一个网络</div><div class="line">net-define      从一个 XML 文件定义(但不开始)一个网络</div><div class="line">net-destroy     删除一个网络</div><div class="line">net-dumpxml     XML 中的网络信息</div><div class="line">net-edit        为网络编辑 XML 配置</div><div class="line">net-list        列出网络</div><div class="line">net-name        把一个网络UUID 转换为网络名</div><div class="line">net-start       开始一个(以前定义的)不活跃的网络</div><div class="line">net-undefine    取消定义一个非活跃的网络</div><div class="line">net-uuid        把一个网络名转换为网络UUID</div><div class="line">iface-list      list physical host interfaces</div><div class="line">iface-name      convert an interface MAC address to interface name</div><div class="line">iface-mac       convert an interface name to interface MAC address</div><div class="line">iface-dumpxml   interface information <span class="keyword">in</span> XML</div><div class="line">iface-define    define (but don<span class="string">'t start) a physical host interface from an XML file</span></div><div class="line"><span class="string">iface-undefine  undefine a physical host interface (remove it from configuration)</span></div><div class="line"><span class="string">iface-edit      edit XML configuration for a physical host interface</span></div><div class="line"><span class="string">iface-start     start a physical host interface (enable it / "if-up")</span></div><div class="line"><span class="string">iface-destroy   destroy a physical host interface (disable it / "if-down")</span></div><div class="line"><span class="string">managedsave     managed save of a domain state</span></div><div class="line"><span class="string">nodeinfo        节点信息</span></div><div class="line"><span class="string">nodedev-list    这台主机中中的枚举设备</span></div><div class="line"><span class="string">nodedev-dumpxml XML 中的节点设备详情</span></div><div class="line"><span class="string">nodedev-dettach dettach node device from its device driver</span></div><div class="line"><span class="string">nodedev-reattach reattach node device to its device driver</span></div><div class="line"><span class="string">nodedev-reset   重置节点设备</span></div><div class="line"><span class="string">nodedev-create  create a device defined by an XML file on the node</span></div><div class="line"><span class="string">nodedev-destroy destroy a device on the node</span></div><div class="line"><span class="string">nwfilter-define define or update a network filter from an XML file</span></div><div class="line"><span class="string">nwfilter-undefine undefine a network filter</span></div><div class="line"><span class="string">nwfilter-dumpxml network filter information in XML</span></div><div class="line"><span class="string">nwfilter-list   list network filters</span></div><div class="line"><span class="string">nwfilter-edit   edit XML configuration for a network filter</span></div><div class="line"><span class="string">pool-autostart  自动启动某个池</span></div><div class="line"><span class="string">pool-build      建立池</span></div><div class="line"><span class="string">pool-create     从一个 XML 文件中创建一个池</span></div><div class="line"><span class="string">pool-create-as  从一组变量中创建一个池</span></div><div class="line"><span class="string">pool-define     在一个 XML 文件中定义（但不启动）一个池</span></div><div class="line"><span class="string">pool-define-as  在一组变量中定义池</span></div><div class="line"><span class="string">pool-destroy    销毁池</span></div><div class="line"><span class="string">pool-delete     删除池</span></div><div class="line"><span class="string">pool-dumpxml    XML 中的池信息</span></div><div class="line"><span class="string">pool-edit       为存储池编辑 XML 配置</span></div><div class="line"><span class="string">pool-info       存储池信息</span></div><div class="line"><span class="string">pool-list       列出池</span></div><div class="line"><span class="string">pool-name       将池 UUID 转换为池名称</span></div><div class="line"><span class="string">pool-refresh    刷新池</span></div><div class="line"><span class="string">pool-start      启动一个（以前定义的）非活跃的池</span></div><div class="line"><span class="string">pool-undefine   取消定义一个不活跃的池</span></div><div class="line"><span class="string">pool-uuid       把一个池名称转换为池 UUID</span></div><div class="line"><span class="string">secret-define   define or modify a secret from an XML file</span></div><div class="line"><span class="string">secret-dumpxml  secret attributes in XML</span></div><div class="line"><span class="string">secret-set-value set a secret value</span></div><div class="line"><span class="string">secret-get-value Output a secret value</span></div><div class="line"><span class="string">secret-undefine undefine a secret</span></div><div class="line"><span class="string">secret-list     list secrets</span></div><div class="line"><span class="string">pwd             print the current directory</span></div><div class="line"><span class="string">quit            退出这个非交互式终端</span></div><div class="line"><span class="string">exit            退出这个非交互式终端</span></div><div class="line"><span class="string">reboot          重新启动一个域</span></div><div class="line"><span class="string">restore         从一个存在一个文件中的状态恢复一个域</span></div><div class="line"><span class="string">resume          重新恢复一个域</span></div><div class="line"><span class="string">save            把一个域的状态保存到一个文件</span></div><div class="line"><span class="string">schedinfo       显示/设置日程安排变量</span></div><div class="line"><span class="string">dump            把一个域的内核 dump 到一个文件中以方便分析</span></div><div class="line"><span class="string">shutdown        关闭一个域</span></div><div class="line"><span class="string">setmem          改变内存的分配</span></div><div class="line"><span class="string">setmaxmem       改变最大内存限制值</span></div><div class="line"><span class="string">setvcpus        改变虚拟 CPU 的号</span></div><div class="line"><span class="string">suspend         挂起一个域</span></div><div class="line"><span class="string">ttyconsole      tty 控制台</span></div><div class="line"><span class="string">undefine        取消定义一个非活跃的域</span></div><div class="line"><span class="string">update-device   update device from an XML file</span></div><div class="line"><span class="string">uri             打印管理程序典型的URI</span></div><div class="line"><span class="string">vol-create      从一个 XML 文件创建一个卷</span></div><div class="line"><span class="string">vol-create-from create a vol, using another volume as input</span></div><div class="line"><span class="string">vol-create-as   从一组变量中创建卷</span></div><div class="line"><span class="string">vol-clone       clone a volume.</span></div><div class="line"><span class="string">vol-delete      删除卷</span></div><div class="line"><span class="string">vol-wipe        wipe a vol</span></div><div class="line"><span class="string">vol-dumpxml     XML 中的卷信息</span></div><div class="line"><span class="string">vol-info        存储卷信息</span></div><div class="line"><span class="string">vol-list        列出卷</span></div><div class="line"><span class="string">vol-pool        returns the storage pool for a given volume key or path</span></div><div class="line"><span class="string">vol-path        returns the volume path for a given volume name or key</span></div><div class="line"><span class="string">vol-name        returns the volume name for a given volume key or path</span></div><div class="line"><span class="string">vol-key         returns the volume key for a given volume name or path</span></div><div class="line"><span class="string">vcpuinfo        域 vcpu 的信息</span></div><div class="line"><span class="string">vcpupin         控制域 vcpu affinity</span></div><div class="line"><span class="string">version         显示版本</span></div><div class="line"><span class="string">vncdisplay      vnc 显示</span></div><div class="line"><span class="string">snapshot-create Create a snapshot</span></div><div class="line"><span class="string">snapshot-current Get the current snapshot</span></div><div class="line"><span class="string">snapshot-delete Delete a domain snapshot</span></div><div class="line"><span class="string">snapshot-dumpxml Dump XML for a domain snapshot</span></div><div class="line"><span class="string">snapshot-list   List snapshots for a domain</span></div><div class="line"><span class="string">snapshot-revert Revert a domain to a snapshot</span></div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;这篇本来应该上周五就写的，但是家里有事，今天补上。&lt;br&gt;周五开发的时候发现之前装的虚拟机，系统一跑起来dplane就挂了，然后排查原因，是因为装虚拟机的时候分配的内存不够用，于是想要使用KVM进行虚拟内存的调整，将内存从1Gb调整到2Gb，后来系统顺利跑起来了。&lt;br&gt;以下内容是总结之后的内容，包含工作需要以外的拓展内容：&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Linux, KVM" scheme="http://weibo.com/categories/Linux-KVM/"/>
    
    
  </entry>
  
  <entry>
    <title>js滚动事件无法触发的处理</title>
    <link href="http://weibo.com/2018/12/10/js%E6%BB%9A%E5%8A%A8%E4%BA%8B%E4%BB%B6%E6%97%A0%E6%B3%95%E8%A7%A6%E5%8F%91%E7%9A%84%E5%A4%84%E7%90%86/"/>
    <id>http://weibo.com/2018/12/10/js滚动事件无法触发的处理/</id>
    <published>2018-12-10T08:22:24.000Z</published>
    <updated>2018-12-10T08:58:50.275Z</updated>
    
    <content type="html"><![CDATA[<p>今天修改Bug的时候需要用到scroll()相关的东西，发现却无法触发滚动事件，于是总结了以下几点原因：<br><a id="more"></a></p>
<h2 id="问题原因"><a href="#问题原因" class="headerlink" title="问题原因"></a>问题原因</h2><p>1、少字符<br>2、错中英文符号<br>3、运用方式有问题（js jq运用方式有问题）一种是onscroll  后者是scroll<br>4、触发原理：没有达到触发条件 这是一种很难发现与改正的问题</p>
<p>scroll触发条件为 事件在元素滚动条在滚动时候触发。</p>
<p>很奇怪对吧！有滚动条滚动了却没有触发这是什么问题。。。。这时候要看看滚动条在哪里 是不是在window上面的滚动条，如果不是那有可能在哪里，自己定义的大盒子（和body一样大的盒子包含所有的内容）里面。</p>
<p>当 html,body{width:100%;height:100%;} 绑定在window或者body无法触发onscroll和scroll  即jq和js都不会触发scroll事件！</p>
<h2 id="在开发中我们经常会遇到这样的需求"><a href="#在开发中我们经常会遇到这样的需求" class="headerlink" title="在开发中我们经常会遇到这样的需求"></a>在开发中我们经常会遇到这样的需求</h2><p>1、当页面滑动到顶部的时候<br>2、当页面滑动到底部的时候（滑动到底部加载更多数据）<br>3、某个元素进入可视区范围的时候(图片懒加载)</p>
<h4 id="通常要实现这些判断的话就必须对网页中的各种高度有个清晰的了解，如页面可视高度，页面总内容高度以及页面滚动的高度等"><a href="#通常要实现这些判断的话就必须对网页中的各种高度有个清晰的了解，如页面可视高度，页面总内容高度以及页面滚动的高度等" class="headerlink" title="通常要实现这些判断的话就必须对网页中的各种高度有个清晰的了解，如页面可视高度，页面总内容高度以及页面滚动的高度等"></a>通常要实现这些判断的话就必须对网页中的各种高度有个清晰的了解，如页面可视高度，页面总内容高度以及页面滚动的高度等</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var scrollTop = $(this).scrollTop();//滚动条的高度，即页面滚动的高度</div><div class="line">var scrollHeight = $(document).height();//页面总内容的高度</div><div class="line">var windowHeight = $(this).height();//页面可视区的高度即设备的高度</div></pre></td></tr></table></figure>
<h4 id="当页面滑动到底部的时候也就是说，滚动的高度和可视区的高度二者相加等于页面内容的高度"><a href="#当页面滑动到底部的时候也就是说，滚动的高度和可视区的高度二者相加等于页面内容的高度" class="headerlink" title="当页面滑动到底部的时候也就是说，滚动的高度和可视区的高度二者相加等于页面内容的高度."></a>当页面滑动到底部的时候也就是说，滚动的高度和可视区的高度二者相加等于页面内容的高度.</h4><p>当页面滑动到顶部的时候也就是说滚动的高度等于0<br>因此通常需要采用以下两个判断函数：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">//判断页面是否滚动到了底部</div><div class="line"><span class="keyword">function</span> <span class="function"><span class="title">judgeIfTop</span></span>()&#123;</div><div class="line">    var scrollTop = $(this).scrollTop();//滚动条的高度，即页面滚动的高度</div><div class="line">    <span class="keyword">if</span>(scrollTop == 0)&#123;</div><div class="line">        <span class="built_in">return</span> <span class="literal">true</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">//判断页面是否滚动到了底部</div><div class="line"><span class="keyword">function</span> <span class="function"><span class="title">judgeIfBottom</span></span>()&#123;</div><div class="line">    var scrollTop = $(this).scrollTop();//滚动条的高度，即页面滚动的高度</div><div class="line">    var scrollHeight = $(document).height();//页面总内容的高度</div><div class="line">    var windowHeight = $(this).height();//页面可视区的高度即设备的高度</div><div class="line">    <span class="keyword">if</span>(scrollTop + windowHeight == scrollHeight)&#123;</div><div class="line">        <span class="built_in">return</span> <span class="literal">true</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="还有一种经常应用的场景就是图片懒加载，懒加载一个最重要的核心就是要判断图片是否进入了可视区，获元素的offsetTop，如果offsetTop的值大于或等于滚动的高度则该元素进入可视区内"><a href="#还有一种经常应用的场景就是图片懒加载，懒加载一个最重要的核心就是要判断图片是否进入了可视区，获元素的offsetTop，如果offsetTop的值大于或等于滚动的高度则该元素进入可视区内" class="headerlink" title="还有一种经常应用的场景就是图片懒加载，懒加载一个最重要的核心就是要判断图片是否进入了可视区，获元素的offsetTop，如果offsetTop的值大于或等于滚动的高度则该元素进入可视区内"></a>还有一种经常应用的场景就是图片懒加载，懒加载一个最重要的核心就是要判断图片是否进入了可视区，获元素的offsetTop，如果offsetTop的值大于或等于滚动的高度则该元素进入可视区内</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">//判断元素是否进入了可视区域</div><div class="line"><span class="keyword">function</span> judgeIfView(ele)&#123;</div><div class="line">    var offsetTop = document.getElementById(ele).offsetTop;</div><div class="line">    var scrollTop = $(this).scrollTop();//滚动条的高度，即页面滚动的高度</div><div class="line">    var windowHeight = $(this).height();//页面可视区的高度即设备的高度</div><div class="line">    <span class="keyword">if</span> (offsetTop &gt;= scrollTop&amp;&amp; offsetTop &lt; scrollTop+windowHeight) &#123;</div><div class="line">        console.log(<span class="string">"图片开始进入可视范围"</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;今天修改Bug的时候需要用到scroll()相关的东西，发现却无法触发滚动事件，于是总结了以下几点原因：&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://weibo.com/categories/JavaScript/"/>
    
    
  </entry>
  
  <entry>
    <title>js常见正则表达式和控制输入框输入</title>
    <link href="http://weibo.com/2018/12/07/js%E5%B8%B8%E8%A7%81%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%92%8C%E6%8E%A7%E5%88%B6%E8%BE%93%E5%85%A5%E6%A1%86%E8%BE%93%E5%85%A5/"/>
    <id>http://weibo.com/2018/12/07/js常见正则表达式和控制输入框输入/</id>
    <published>2018-12-07T05:33:08.000Z</published>
    <updated>2018-12-07T05:43:16.883Z</updated>
    
    <content type="html"><![CDATA[<p>在日常工作中常常会使用到正则表达式，主要是输入框。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">验证数字：^[0-9]*$</div><div class="line">验证n位的数字：^\d&#123;n&#125;$</div><div class="line">验证至少n位数字：^\d&#123;n,&#125;$</div><div class="line">验证m-n位的数字：^\d&#123;m,n&#125;$</div><div class="line">验证零和非零开头的数字：^(0|[1-9][0-9]*)$</div><div class="line">验证有两位小数的正实数：^[0-9]+(.[0-9]&#123;2&#125;)?$</div><div class="line">验证有1-3位小数的正实数：^[0-9]+(.[0-9]&#123;1,3&#125;)?$</div><div class="line">验证非零的正整数：^\+?[1-9][0-9]*$</div><div class="line">验证非零的负整数：^\-[1-9][0-9]*$</div><div class="line">验证非负整数（正整数 + 0） ^\d+$</div><div class="line">验证非正整数（负整数 + 0） ^((-\d+)|(0+))$</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">验证长度为3的字符：^.&#123;3&#125;$</div><div class="line">验证由26个英文字母组成的字符串：^[A-Za-z]+$</div><div class="line">验证由26个大写英文字母组成的字符串：^[A-Z]+$</div><div class="line">验证由26个小写英文字母组成的字符串：^[a-z]+$</div><div class="line">验证由数字和26个英文字母组成的字符串：^[A-Za-z0-9]+$</div><div class="line">验证由数字、26个英文字母或者下划线组成的字符串：^\w+$</div><div class="line">验证用户密码:^[a-zA-Z]\w&#123;5,17&#125;$ 正确格式为：以字母开头，长度在6-18之间，只能包含字符、数字和下划线。</div><div class="line">验证是否含有 ^%&amp;<span class="string">',;=?$\" 等字符：[^%&amp;'</span>,;=?$\x22]+</div><div class="line">验证汉字：^[\u4e00-\u9fa5],&#123;0,&#125;$</div><div class="line">验证Email地址：</div><div class="line">^\w+[-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$</div><div class="line">验证URL：</div><div class="line">^http://([\w-]+\.)+[\w-]+(/[\w-./?%&amp;=]*)?$ ；^[a-zA-z]+://(w+(-w+)*)(.(w+(-w+)*))*(?S*)?$</div><div class="line">验证电话号码：</div><div class="line">^(\(\d&#123;3,4&#125;\)|\d&#123;3,4&#125;-)?\d&#123;7,8&#125;$：--正确格式为：XXXX-XXXXXXX，XXXX-XXXXXXXX，XXX-XXXXXXX，XXX-XXXXXXXX，XXXXXXX，XXXXXXXX。</div><div class="line">验证身份证号（15位或18位数字）：^\d&#123;15&#125;|\d&#123;&#125;18$</div><div class="line">验证一年的12个月：^(0?[1-9]|1[0-2])$ 正确格式为：“01”-“09”和“1”“12”</div><div class="line">验证一个月的31天：</div><div class="line">^((0?[1-9])|((1|2)[0-9])|30|31)$ 正确格式为：01、09和1、31。</div><div class="line">整数：^-?\d+$</div><div class="line">非负浮点数（正浮点数 + 0）：^\d+(\.\d+)?$</div><div class="line">正浮点数 ^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$</div><div class="line">非正浮点数（负浮点数 + 0） ^((-\d+(\.\d+)?)|(0+(\.0+)?))$</div><div class="line">负浮点数 ^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$</div><div class="line">浮点数 ^(-?\d+)(\.\d+)?$</div></pre></td></tr></table></figure>
<h2 id="用js控制输入框input数字、汉字、字符"><a href="#用js控制输入框input数字、汉字、字符" class="headerlink" title="用js控制输入框input数字、汉字、字符"></a>用js控制输入框input数字、汉字、字符</h2><p>1.文本框只能输入数字代码(小数点也不能输入)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input onkeyup=<span class="string">"this.value=this.value.replace(/\D/g,'')"</span> onafterpaste=<span class="string">"this.value=this.value.replace(/\D/g,'')"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>2.只能输入数字,能输小数点.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;input onkeyup=<span class="string">"if(isNaN(value))execCommand('undo')"</span> onafterpaste=<span class="string">"if(isNaN(value))execCommand('undo')"</span>&gt;</div><div class="line">&lt;input name=txt1 onchange=<span class="string">"if(/\D/.test(this.value))&#123;alert('只能输入数字');this.value='';&#125;"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>3.数字和小数点方法二<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input <span class="built_in">type</span>=text t_value=<span class="string">""</span> o_value=<span class="string">""</span> onkeypress=<span class="string">"if(!this.value.match(/^[\+\-]?\d*?\.?\d*?$/))this.value=this.t_value;else this.t_value=this.value;if(this.value.match(/^(?:[\+\-]?\d+(?:\.\d+)?)?$/))this.o_value=this.value"</span> onkeyup=<span class="string">"if(!this.value.match(/^[\+\-]?\d*?\.?\d*?$/))this.value=this.t_value;else this.t_value=this.value;if(this.value.match(/^(?:[\+\-]?\d+(?:\.\d+)?)?$/))this.o_value=this.value"</span> onblur=<span class="string">"if(!this.value.match(/^(?:[\+\-]?\d+(?:\.\d+)?|\.\d*?)?$/))this.value=this.o_value;else&#123;if(this.value.match(/^\.\d+$/))this.value=0+this.value;if(this.value.match(/^\.$/))this.value=0;this.o_value=this.value&#125;"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>4.只能输入字母和汉字<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input onkeyup=<span class="string">"value=value.replace(/[\d]/g,'') "</span>onbeforepaste=<span class="string">"clipboardData.setData('text',clipboardData.getData('text').replace(/[\d]/g,''))"</span> maxlength=10 name=<span class="string">"Numbers"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>5.只能输入英文字母和数字,不能输入中文<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input onkeyup=<span class="string">"value=value.replace(/[^\w\.\/]/ig,'')"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>6.只能输入数字和英文<font color="Red">chun</font><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input onKeyUp=<span class="string">"value=value.replace(/[^\d|chun]/g,'')"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>7.小数点后只能有最多两位(数字,中文都可输入),不能输入字母和运算符号:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input onKeyPress=<span class="string">"if((event.keyCode&lt;48 || event.keyCode&gt;57) &amp;&amp; event.keyCode!=46 || /\.\d\d$/.test(value))event.returnValue=false"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>8.小数点后只能有最多两位(数字,字母,中文都可输入),可以输入运算符号:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;input onkeyup=<span class="string">"this.value=this.value.replace(/^(\-)*(\d+)\.(\d\d).*$/,'<span class="variable">$1</span><span class="variable">$2</span>.<span class="variable">$3</span>')"</span>&gt;</div><div class="line">只能是数字和小数点和加减乘際</div><div class="line">onkeypress=<span class="string">"return event.keyCode&gt;=4&amp;&amp;event.keyCode&lt;=57"</span></div></pre></td></tr></table></figure></p>
<h2 id="以下未经测试，请验证后使用"><a href="#以下未经测试，请验证后使用" class="headerlink" title="以下未经测试，请验证后使用"></a>以下未经测试，请验证后使用</h2><p>1.只能输入数字和英文的：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input onkeyup=<span class="string">"value=value.replace(/[\W]/g,'') "</span> onbeforepaste=<span class="string">"clipboardData.setData('text',clipboardData.getData('text').replace(/[^\d]/g,''))"</span> ID=<span class="string">"Text1"</span> NAME=<span class="string">"Text1"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>2.只能输入数字的：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input onkeyup=<span class="string">"value=value.replace(/[^\d]/g,'') "</span> onbeforepaste=<span class="string">"clipboardData.setData('text',clipboardData.getData('text').replace(/[^\d]/g,''))"</span> ID=<span class="string">"Text2"</span> NAME=<span class="string">"Text2"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>3.只能输入全角的：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input onkeyup=<span class="string">"value=value.replace(/[^\uFF00-\uFFFF]/g,'')"</span> onbeforepaste=<span class="string">"clipboardData.setData('text',clipboardData.getData('text').replace(/[^\uFF00-\uFFFF]/g,''))"</span> ID=<span class="string">"Text3"</span> NAME=<span class="string">"Text3"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>4.只能输入汉字的：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input onkeyup=<span class="string">"value=value.replace(/[^\u4E00-\u9FA5]/g,'')"</span> onbeforepaste=<span class="string">"clipboardData.setData('text',clipboardData.getData('text').replace(/[^\u4E00-\u9FA5]/g,''))"</span> ID=<span class="string">"Text4"</span> NAME=<span class="string">"Text4"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>5.邮件地址验证：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var regu = <span class="string">"^(([0-9a-zA-Z]+)|([0-9a-zA-Z]+[_.0-9a-zA-Z-]*[0-9a-zA-Z]+))@([a-zA-Z0-9-]+[.])+([a-zA-Z]&#123;2&#125;|net|NET|com|COM|gov|GOV|mil|MIL|org|ORG|edu|EDU|int|INT)$"</span></div><div class="line">var re = new RegExp(regu);</div><div class="line"><span class="keyword">if</span> (s.search(re) != -1) &#123;</div><div class="line">    <span class="built_in">return</span> <span class="literal">true</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    window.alert (<span class="string">"请输入有效合法的E-mail地址 ！"</span>)</div><div class="line">    <span class="built_in">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>6.身份证：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"^\\d&#123;17&#125;(\\d|x)$"</span></div></pre></td></tr></table></figure></p>
<p>7.17种正则表达式<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">/^[a-zA-Z0-9\u4e00-\u9fa5]+$/  数字文字字母</div><div class="line"><span class="string">"^\\d+$"</span>　　//非负整数（正整数 + 0）</div><div class="line"><span class="string">"^[0-9]*[1-9][0-9]*$"</span>　　//正整数</div><div class="line"><span class="string">"^((-\\d+)|(0+))$"</span>　　//非正整数（负整数 + 0）</div><div class="line"><span class="string">"^-[0-9]*[1-9][0-9]*$"</span>　　//负整数</div><div class="line"><span class="string">"^-?\\d+$"</span>　　　　//整数</div><div class="line"><span class="string">"^\\d+(\\.\\d+)?$"</span>　　//非负浮点数（正浮点数 + 0）</div><div class="line"><span class="string">"^(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*))$"</span>　　//正浮点数</div><div class="line"><span class="string">"^((-\\d+(\\.\\d+)?)|(0+(\\.0+)?))$"</span>　　//非正浮点数（负浮点数 + 0）</div><div class="line"><span class="string">"^(-(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*)))$"</span>　　//负浮点数</div><div class="line"><span class="string">"^(-?\\d+)(\\.\\d+)?$"</span>　　//浮点数</div><div class="line"><span class="string">"^[A-Za-z]+$"</span>　　//由26个英文字母组成的字符串</div><div class="line"><span class="string">"^[A-Z]+$"</span>　　//由26个英文字母的大写组成的字符串</div><div class="line"><span class="string">"^[a-z]+$"</span>　　//由26个英文字母的小写组成的字符串</div><div class="line"><span class="string">"^[A-Za-z0-9]+$"</span>　　//由数字和26个英文字母组成的字符串</div><div class="line"><span class="string">"^\\w+$"</span>　　//由数字、26个英文字母或者下划线组成的字符串</div><div class="line"><span class="string">"^[\\w-]+(\\.[\\w-]+)*@[\\w-]+(\\.[\\w-]+)+$"</span>　　　　//email地址</div><div class="line"><span class="string">"^[a-zA-z]+://(\\w+(-\\w+)*)(\\.(\\w+(-\\w+)*))*(\\?\\S*)?$"</span>　　//url</div></pre></td></tr></table></figure></p>
<h2 id="控制输入框输入"><a href="#控制输入框输入" class="headerlink" title="控制输入框输入"></a>控制输入框输入</h2><p>1.取消按钮按下时的虚线框<br>　　在input里添加属性值 hideFocus 或者 HideFocus=true<br>2.只读文本框内容<br>    在input里添加属性值 readonly<br>3.防止退后清空的TEXT文档(可把style内容做做为类引用)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;INPUT style=behavior:url(<span class="comment">#default#savehistory); type=text id=oPersistInput&gt;</span></div></pre></td></tr></table></figure></p>
<p>4.ENTER键可以让光标移到下一个输入框<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input onkeydown=<span class="string">"if(event.keyCode==13)event.keyCode=9"</span> &gt;</div></pre></td></tr></table></figure></p>
<p>5.只能为中文(有闪动)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input onkeyup=<span class="string">"value="</span>/value.replace(/[<span class="string">"-~]/g,’’)"</span> onkeydown=<span class="string">"if(event.keyCode==13)event.keyCode=9"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>6.只能为数字(有闪动)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input onkeyup=<span class="string">"value="</span>/value.replace(/[<span class="string">"^\d]/g,’’) "</span>onbeforepaste=<span class="string">"clipboardData.setData(’text’,clipboardData.getData(’text’).replace(/[^\d]/g,’’))"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>7.只能为数字(无闪动)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input ime-mode:disabled<span class="string">" onkeydown="</span><span class="keyword">if</span>(event.keyCode==13)event.keyCode=9<span class="string">" onKeyPress="</span><span class="keyword">if</span> ((event.keyCode&lt;48 || event.keyCode&gt;57)) event.returnValue=<span class="literal">false</span><span class="string">"&gt;</span></div></pre></td></tr></table></figure></p>
<p>8.只能输入英文和数字(有闪动)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input onkeyup=<span class="string">"value="</span>/value.replace(/[\W]/g,<span class="string">"’’)"</span> onbeforepaste=<span class="string">"clipboardData.setData(’text’,clipboardData.getData(’text’).replace(/[^\d]/g,’’))"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>9.屏蔽输入法<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input <span class="built_in">type</span>=<span class="string">"text"</span> name=<span class="string">"url"</span> ime-mode:disabled<span class="string">" onkeydown="</span><span class="keyword">if</span>(event.keyCode==13)event.keyCode=9<span class="string">"&gt;</span></div></pre></td></tr></table></figure></p>
<p>10.只能输入 数字，小数点，减号（-） 字符(无闪动)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input onKeyPress=<span class="string">"if (event.keyCode!=46 &amp;&amp; event.keyCode!=45 &amp;&amp; (event.keyCode&lt;48 || event.keyCode&gt;57)) event.returnValue=false"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>11.只能输入两位小数，三位小数(有闪动)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;input maxlength=9 onkeyup=<span class="string">"if(value.match(/^\d&#123;3&#125;$/))value="</span>/value.replace(value,parseInt(value/10))<span class="string">" ;value="</span>/value.replace(/\.\d*\./g,’.<span class="string">"’)"</span> onKeyPress=<span class="string">"if((event.keyCode&lt;48 || event.keyCode&gt;57) &amp;&amp; event.keyCode!=46 &amp;&amp; event.keyCode!=45 || value.match(/^\d&#123;3&#125;$/) || /\.\d&#123;3&#125;$/.test(value)) &#123;event.returnValue=false&#125;"</span> id=text_kfxe name=text_kfxe&gt;</div><div class="line"><span class="string">"^\\d+$"</span>　　//非负整数（正整数 + 0）</div><div class="line"><span class="string">"^[0-9]*[1-9][0-9]*$"</span>　　//正整数</div><div class="line"><span class="string">"^((-\\d+)|(0+))$"</span>　　//非正整数（负整数 + 0）</div><div class="line"><span class="string">"^-[0-9]*[1-9][0-9]*$"</span>　　//负整数</div><div class="line"><span class="string">"^-?\\d+$"</span>　　　　//整数</div><div class="line"><span class="string">"^\\d+(\\.\\d+)?$"</span>　　//非负浮点数（正浮点数 + 0）</div><div class="line"><span class="string">"^(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*))$"</span>　　//正浮点数</div><div class="line"><span class="string">"^((-\\d+(\\.\\d+)?)|(0+(\\.0+)?))$"</span>　　//非正浮点数（负浮点数 + 0）</div><div class="line"><span class="string">"^(-(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*)))$"</span>　　//负浮点数</div><div class="line"><span class="string">"^(-?\\d+)(\\.\\d+)?$"</span>　　//浮点数</div><div class="line"><span class="string">"^[A-Za-z]+$"</span>　　//由26个英文字母组成的字符串</div><div class="line"><span class="string">"^[A-Z]+$"</span>　　//由26个英文字母的大写组成的字符串</div><div class="line"><span class="string">"^[a-z]+$"</span>　　//由26个英文字母的小写组成的字符串</div><div class="line"><span class="string">"^[A-Za-z0-9]+$"</span>　　//由数字和26个英文字母组成的字符串</div><div class="line"><span class="string">"^\\w+$"</span>　　//由数字、26个英文字母或者下划线组成的字符串</div><div class="line"><span class="string">"^[\\w-]+(\\.[\\w-]+)*@[\\w-]+(\\.[\\w-]+)+$"</span>　　　　//email地址</div><div class="line"><span class="string">"^[a-zA-z]+://(\\w+(-\\w+)*)(\\.(\\w+(-\\w+)*))*(\\?\\S*)?$"</span>　　//url</div><div class="line"><span class="string">"^((\d&#123;1,3&#125;(,\d&#123;3&#125;)*?)|\d+)(\.\d+)?$ //带逗号的decimal</span></div></pre></td></tr></table></figure></p>
<h3 id="具体的使用"><a href="#具体的使用" class="headerlink" title="具体的使用"></a>具体的使用</h3><p>``` bash</p>
<p><script language="JavaScript"><br>var mm=/^\d+$/;<br>function formCheck(){<br>    if(!mm.test(document.f1.PropertyAmount.value)){<br>        alert(“请输入合法的数字”);<br>        document.f1.PropertyAmount.focus();<br>        return false;<br>    }<br>    return true;<br>}</p>
</script></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在日常工作中常常会使用到正则表达式，主要是输入框。&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;验证数字：^[0-9]*$&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;验证n位的数字：^\d&amp;#123;n&amp;#125;$&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;验证至少n位数字：^\d&amp;#123;n,&amp;#125;$&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;验证m-n位的数字：^\d&amp;#123;m,n&amp;#125;$&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;验证零和非零开头的数字：^(0|[1-9][0-9]*)$&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;验证有两位小数的正实数：^[0-9]+(.[0-9]&amp;#123;2&amp;#125;)?$&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;验证有1-3位小数的正实数：^[0-9]+(.[0-9]&amp;#123;1,3&amp;#125;)?$&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;验证非零的正整数：^\+?[1-9][0-9]*$&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;验证非零的负整数：^\-[1-9][0-9]*$&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;验证非负整数（正整数 + 0） ^\d+$&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;验证非正整数（负整数 + 0） ^((-\d+)|(0+))$&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://weibo.com/categories/JavaScript/"/>
    
    
  </entry>
  
  <entry>
    <title>原生js合并两个数组以及call,apply,bind</title>
    <link href="http://weibo.com/2018/12/07/%E5%8E%9F%E7%94%9Fjs%E5%90%88%E5%B9%B6%E4%B8%A4%E4%B8%AA%E6%95%B0%E7%BB%84%E4%BB%A5%E5%8F%8Acall-apply-bind/"/>
    <id>http://weibo.com/2018/12/07/原生js合并两个数组以及call-apply-bind/</id>
    <published>2018-12-07T05:06:29.000Z</published>
    <updated>2018-12-07T05:45:42.319Z</updated>
    
    <content type="html"><![CDATA[<h2 id="js合并两个数组"><a href="#js合并两个数组" class="headerlink" title="js合并两个数组"></a>js合并两个数组</h2><p>如：<br>var a = [1,2,3];<br>var b = [4,5,6];</p>
<h3 id="1、concat"><a href="#1、concat" class="headerlink" title="1、concat"></a>1、concat</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var c = a.concat(b); //c=[1,2,3,4,5,6]</div></pre></td></tr></table></figure>
<p>问题：concat方法连接a、b两个数组后，a、b两个数组的数据不变，同时会返回一个新的数组。这样当我们需要进行多次的数组合并时，会造成很大的内存浪费<br><a id="more"></a></p>
<h3 id="2、for循环"><a href="#2、for循环" class="headerlink" title="2、for循环"></a>2、for循环</h3><p>遍历其中一个数组，把该数组中的所有元素依次添加到另外一个数组中<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span>(var i <span class="keyword">in</span> b) &#123;</div><div class="line">    a.push(b[i]);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="3、apply"><a href="#3、apply" class="headerlink" title="3、apply"></a>3、apply</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">push.apply(a,b)   等同于  a.push.apply(a,[4,5,6])</div></pre></td></tr></table></figure>
<h3 id="4、说明："><a href="#4、说明：" class="headerlink" title="4、说明："></a>4、说明：</h3><p>1）以上3种合并方法并没有考虑过a、b两个数组谁的长度更小。<br>2）所以好的做法是预先判断a、b两个数组哪个更大，然后使用大数组合并小数组，这样就减少了数组元素操作的次数！<br>3）有时候我们不希望原数组（a、b）改变，这时就只能使用concat了。</p>
<h2 id="call-apply-bind"><a href="#call-apply-bind" class="headerlink" title="call(), apply(), bind()"></a>call(), apply(), bind()</h2><h3 id="示例1："><a href="#示例1：" class="headerlink" title="示例1："></a>示例1：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">var name=<span class="string">'zhang'</span>,age=17;</div><div class="line">var obj = &#123;</div><div class="line">    name: <span class="string">'hong'</span>,</div><div class="line">    objAge: this.age,</div><div class="line">    myFun: <span class="function"><span class="title">function</span></span>()&#123;</div><div class="line">        console.log(this.name+<span class="string">','</span>+this.age);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">obj.objAge;  //17</div><div class="line">obj.myFun()  //hong,undefined</div></pre></td></tr></table></figure>
<h3 id="示例2："><a href="#示例2：" class="headerlink" title="示例2："></a>示例2：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var name = <span class="string">'yuan'</span>;</div><div class="line"><span class="keyword">function</span> <span class="function"><span class="title">show</span></span>()&#123;</div><div class="line">    console.log(this.name);</div><div class="line">&#125;</div><div class="line"></div><div class="line">show() //yuan</div></pre></td></tr></table></figure>
<h4 id="比较一下这两者this-的差别，第一个this指向obj，第二个全局声明的shows-函数this是window"><a href="#比较一下这两者this-的差别，第一个this指向obj，第二个全局声明的shows-函数this是window" class="headerlink" title="比较一下这两者this 的差别，第一个this指向obj，第二个全局声明的shows()函数this是window;"></a>比较一下这两者this 的差别，第一个this指向obj，第二个全局声明的shows()函数this是window;</h4><h3 id="call-、apply-、bind-都是用来重定义-this这个对象的"><a href="#call-、apply-、bind-都是用来重定义-this这个对象的" class="headerlink" title="call()、apply()、bind() 都是用来重定义 this这个对象的"></a>call()、apply()、bind() 都是用来重定义 this这个对象的</h3><p>如：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">var name=<span class="string">'zhang'</span>,age=17;</div><div class="line">var obj = &#123;</div><div class="line">    name: <span class="string">'hong'</span>,</div><div class="line">    objAge: this.age,</div><div class="line">    myFun: <span class="function"><span class="title">function</span></span>()&#123;</div><div class="line">        console.log(this.name+<span class="string">','</span>+this.age);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">var db = &#123;</div><div class="line">    name: <span class="string">'yuan'</span>,</div><div class="line">    age: 20</div><div class="line">&#125;</div><div class="line"></div><div class="line">obj.myFun.call(db)；　　　//yuan,20</div><div class="line">obj.myFun.apply(db);　　　//yuan,20</div><div class="line">obj.myFun.bind(db)();　　 //yuan,20</div></pre></td></tr></table></figure></p>
<p>以上出了bind方法后面多了个()外 ，结果返回都一致。<br>由此得出结论，bind返回的是一个新的函数，你必须调用它才会被执行。</p>
<h3 id="对比call-、bind-、-apply-传参情况下"><a href="#对比call-、bind-、-apply-传参情况下" class="headerlink" title="对比call 、bind 、 apply 传参情况下"></a>对比call 、bind 、 apply 传参情况下</h3><p>如：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">var name=<span class="string">'zhang'</span>,age=17;</div><div class="line">var obj = &#123;</div><div class="line">    name: <span class="string">'hong'</span>,</div><div class="line">    objAge: this.age,</div><div class="line">    myFun: <span class="keyword">function</span>(fm,t)&#123;</div><div class="line">        console.log(this.name+<span class="string">', '</span>+this.age+<span class="string">', '</span>+fm+<span class="string">'&amp;&amp;'</span>+t);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">var db = &#123;</div><div class="line">    name: <span class="string">'yuan'</span>,</div><div class="line">    age: 20</div><div class="line">&#125;</div><div class="line"></div><div class="line">obj.myFun.call(db,<span class="string">'one'</span>,<span class="string">'two'</span>)；　　　//yuan, 20, one&amp;&amp;two</div><div class="line">obj.myFun.apply(db,[<span class="string">'one'</span>,<span class="string">'two'</span>]);　　　//yuan, 20, one&amp;&amp;two</div><div class="line">obj.myFun.bind(db,<span class="string">'one'</span>,<span class="string">'two'</span>)();　　 //yuan, 20, one&amp;&amp;two</div><div class="line">obj.myFun.bind(db,[<span class="string">'one'</span>,<span class="string">'two'</span>])();　　 //yuan, 20, one,two&amp;&amp;undefined</div></pre></td></tr></table></figure></p>
<p>从上面四个结果不难看出call 、bind 、 apply这三个函数的第一个参数都是this的指向对象，第二个参数差别就来了：<br>call的参数是直接放进去的，第二、第三、第n个参数全都用逗号分隔，直接放到后面  obj.myFun.call(db,’one’, … ,’string’ );<br>apply的所有参数都必须放在一个数组里面传进去obj.myFun.apply(db,[‘one’, …, ‘string’ ]);<br>bind除了返回是函数以外，它的参数和call一样。<br>当然，三者的参数不限定是string类型，允许是各种类型，包括函数 、 object 等等。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;js合并两个数组&quot;&gt;&lt;a href=&quot;#js合并两个数组&quot; class=&quot;headerlink&quot; title=&quot;js合并两个数组&quot;&gt;&lt;/a&gt;js合并两个数组&lt;/h2&gt;&lt;p&gt;如：&lt;br&gt;var a = [1,2,3];&lt;br&gt;var b = [4,5,6];&lt;/p&gt;
&lt;h3 id=&quot;1、concat&quot;&gt;&lt;a href=&quot;#1、concat&quot; class=&quot;headerlink&quot; title=&quot;1、concat&quot;&gt;&lt;/a&gt;1、concat&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;var c = a.concat(b); //c=[1,2,3,4,5,6]&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;问题：concat方法连接a、b两个数组后，a、b两个数组的数据不变，同时会返回一个新的数组。这样当我们需要进行多次的数组合并时，会造成很大的内存浪费&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://weibo.com/categories/JavaScript/"/>
    
    
  </entry>
  
  <entry>
    <title>Linux下打包和解压缩命令并通过PHP进行页面下载</title>
    <link href="http://weibo.com/2018/12/07/Linux%E4%B8%8B%E6%89%93%E5%8C%85%E5%92%8C%E8%A7%A3%E5%8E%8B%E7%BC%A9%E5%91%BD%E4%BB%A4%E5%B9%B6%E9%80%9A%E8%BF%87PHP%E8%BF%9B%E8%A1%8C%E9%A1%B5%E9%9D%A2%E4%B8%8B%E8%BD%BD/"/>
    <id>http://weibo.com/2018/12/07/Linux下打包和解压缩命令并通过PHP进行页面下载/</id>
    <published>2018-12-07T03:36:31.000Z</published>
    <updated>2018-12-07T05:44:57.766Z</updated>
    
    <content type="html"><![CDATA[<p>工作过程中需要将x86设备上的某个文件夹进行打包，然后实现页面下载压缩包的需求。由于工作机上面不支持ZIP工具压缩，于是采用PHP代码嵌入linux tar打包命令实现。<br>PHP代码：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$dir_path</span> = <span class="string">'/disk/report_pdf/'</span>;</div><div class="line"><span class="built_in">exec</span>(<span class="string">'cd '</span>.<span class="variable">$dir_path</span>.<span class="string">' &amp;&amp; tar -zcvf report.tar.gz -C /disk/report_pdf .'</span>); </div><div class="line">// -C参数是解决打包之后带有文件路径的问题，记住最后一定要加 . 。</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<h2 id="拓展-Linux下打包和解压缩命令及参数说明："><a href="#拓展-Linux下打包和解压缩命令及参数说明：" class="headerlink" title="拓展 || Linux下打包和解压缩命令及参数说明："></a>拓展 || Linux下打包和解压缩命令及参数说明：</h2><h3 id="解压缩命令："><a href="#解压缩命令：" class="headerlink" title="解压缩命令："></a>解压缩命令：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line">.tar</div><div class="line">压缩：tar cvf FileName.tar FileName</div><div class="line">解压：tar xvf FileName.tar</div><div class="line">--------------------------------------------- </div><div class="line">.gz</div><div class="line">解压1：gunzip FileName.gz </div><div class="line">解压2：gzip -d FileName.gz </div><div class="line">压缩：gzip FileName </div><div class="line">.tar.gz </div><div class="line">解压：tar zxvf FileName.tar.gz </div><div class="line">压缩：tar zcvf FileName.tar.gz DirName </div><div class="line">--------------------------------------------- </div><div class="line">.bz2 </div><div class="line">解压1：bzip2 -d FileName.bz2 </div><div class="line">解压2：bunzip2 FileName.bz2 </div><div class="line">压缩： bzip2 -z FileName </div><div class="line">.tar.bz2 </div><div class="line">解压：tar jxvf FileName.tar.bz2 </div><div class="line">压缩：tar jcvf FileName.tar.bz2 DirName </div><div class="line">--------------------------------------------- </div><div class="line">.bz </div><div class="line">解压1：bzip2 -d FileName.bz </div><div class="line">解压2：bunzip2 FileName.bz </div><div class="line">压缩：未知 </div><div class="line">.tar.bz </div><div class="line">解压：tar jxvf FileName.tar.bz </div><div class="line">压缩：未知 </div><div class="line">--------------------------------------------- </div><div class="line">.Z </div><div class="line">解压：uncompress FileName.Z </div><div class="line">压缩：compress FileName </div><div class="line">.tar.Z </div><div class="line">解压：tar Zxvf FileName.tar.Z </div><div class="line">压缩：tar Zcvf FileName.tar.Z DirName </div><div class="line">--------------------------------------------- </div><div class="line">.tgz </div><div class="line">解压：tar zxvf FileName.tgz </div><div class="line">压缩：未知 </div><div class="line">.tar.tgz </div><div class="line">解压：tar zxvf FileName.tar.tgz </div><div class="line">压缩：tar zcvf FileName.tar.tgz FileName </div><div class="line">--------------------------------------------- </div><div class="line">.zip </div><div class="line">解压：unzip FileName.zip </div><div class="line">压缩：zip FileName.zip DirName </div><div class="line">--------------------------------------------- </div><div class="line">.rar </div><div class="line">解压：rar a FileName.rar </div><div class="line">压缩：rar e FileName.rar </div><div class="line">--------------------------------------------- </div><div class="line"></div><div class="line">后缀的含义如下：</div><div class="line">.tar打包格式：tar程序打包的数据，并没有压缩过</div><div class="line">.z格式：compress程序压缩的文件</div><div class="line">.gz压缩格式：gzip程序压缩的文件 .bz2压缩格式：bzip2程序压缩的文件</div><div class="line">.tar.gz打包压缩：tar程序打包的文件，其中并且经过 gzip 的压缩</div><div class="line">.tar.bz2打包压缩：tar程序打包的文件，其中并且经过 bzip2 的压缩</div></pre></td></tr></table></figure>
<h3 id="参数说明："><a href="#参数说明：" class="headerlink" title="参数说明："></a>参数说明：</h3><h4 id="1、主选项："><a href="#1、主选项：" class="headerlink" title="1、主选项："></a>1、主选项：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">-c 创建新的档案文件。如果用户想备份一个目录或是一些文件，就要选择这个选项。</div><div class="line">-r 把要存档的文件追加到档案文件的未尾。例如用户已经做好备份文件，又发现还有一个目录或是一些文件忘记备份了，这时可以使用该选项，将忘记的目录或文件追加到备份文件中。</div><div class="line">-t 列出档案文件的内容，查看已经备份了哪些文件。</div><div class="line">-u 更新文件。就是说，用新增的文件取代原备份文件，如果在备份文件中找不到要更新的文件，则把它追加到备份文件的最后。</div><div class="line">-x 从档案文件中释放文件。</div></pre></td></tr></table></figure>
<h4 id="说明：主选项是独立的命令，压缩解压都要用到其中一个，可以和辅助选项连用但这五个命令只能用其中一个。"><a href="#说明：主选项是独立的命令，压缩解压都要用到其中一个，可以和辅助选项连用但这五个命令只能用其中一个。" class="headerlink" title="说明：主选项是独立的命令，压缩解压都要用到其中一个，可以和辅助选项连用但这五个命令只能用其中一个。"></a>说明：主选项是独立的命令，压缩解压都要用到其中一个，可以和辅助选项连用但这五个命令只能用其中一个。</h4><h4 id="2、辅助选项："><a href="#2、辅助选项：" class="headerlink" title="2、辅助选项："></a>2、辅助选项：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">-b 该选项是为磁带机设定的，其后跟一数字，用来说明区块的大小，系统预设值为20（20×512 bytes）。</div><div class="line">-f 指定档案文件名或设备名，这个选项通常是必选的,这个参数是最后一个参数。</div><div class="line">-k 保存已经存在的文件。例如把某个文件还原，在还原的过程中遇到相同的文件，不会进行覆盖。</div><div class="line">-m 在还原文件时，把所有文件的修改时间设定为现在。</div><div class="line">-M 创建多卷的档案文件，以便在几个磁盘中存放。</div><div class="line">-v 详细报告tar处理的文件信息。如无此选项，tar不报告文件信息。</div><div class="line">-w 每一步都要求确认。</div><div class="line">-z 用gzip来压缩/解压缩文件，加上该选项后可以将档案文件进行压缩，但还原时也一定要使用该选项进行解压缩。</div></pre></td></tr></table></figure>
<h3 id="实例："><a href="#实例：" class="headerlink" title="实例："></a>实例：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">tar -cf FileName.tar DirName：这条命令是将DirName的文件夹打成一个名为FileName.tar的包。-c是表示产生新的包，-f指定包的文件名；</div><div class="line"></div><div class="line">tar -cf FileName.tar *.jpg：这条命令是将所有.jpg的文件打成一个名为FileName.tar的包；</div><div class="line"></div><div class="line">tar -rf FileName.tar *.gif：这条命令是将所有.gif的文件增加到FileName.tar的包里面去。-r是表示增加文件的意思；</div><div class="line"></div><div class="line">tar -uf FileName.tar logo.gif：这条命令是更新原来tar包FileName.tar中logo.gif文件，-u是表示更新文件的意思；</div><div class="line"></div><div class="line">tar -tf FileName.tar：这条命令是列出FileName.tar包中所有文件，-t是列出文件的意思；</div><div class="line"></div><div class="line">tar -xf FileName.tar：这条命令是解出FileName.tar包中所有文件，-x是解开的意思</div></pre></td></tr></table></figure>
<h3 id="PHP实现页面压缩包下载"><a href="#PHP实现页面压缩包下载" class="headerlink" title="PHP实现页面压缩包下载"></a>PHP实现页面压缩包下载</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">function</span> back_pacp_file()</div><div class="line">&#123;</div><div class="line">    <span class="variable">$channel</span> = file_get_contents(<span class="string">'/etc/asterisk/channel.conf'</span>);</div><div class="line">    <span class="variable">$date</span> = date(<span class="string">'y-m-d'</span>,time());</div><div class="line">    <span class="variable">$pcap_file_name</span> = <span class="string">"<span class="variable">$date_</span><span class="variable">$channel</span>.tar.gz"</span>;</div><div class="line">    <span class="variable">$pcap_file_path</span> = <span class="string">"/tmp/<span class="variable">$pcap_file_name</span>"</span>;</div><div class="line"></div><div class="line">    <span class="variable">$pack_cmd</span> = <span class="string">"tar vcz -f <span class="variable">$pcap_file_path</span> /tmp/"</span>.<span class="variable">$date</span>.<span class="string">"_"</span>.<span class="variable">$channel</span>.<span class="string">".pcap"</span>;</div><div class="line"></div><div class="line">    <span class="built_in">exec</span>(<span class="string">"<span class="variable">$pack_cmd</span> &gt; /dev/null 2&gt;&amp;1 || echo $?"</span>,<span class="variable">$output</span>);</div><div class="line">    <span class="keyword">if</span>(<span class="variable">$output</span>) &#123;</div><div class="line">        <span class="built_in">echo</span> <span class="string">"&lt;/br&gt;<span class="variable">$pcap_file_name</span> "</span>;</div><div class="line">        <span class="built_in">echo</span> language(<span class="string">"Packing was failed"</span>);<span class="built_in">echo</span> <span class="string">"&lt;/br&gt;"</span>;</div><div class="line">        <span class="built_in">echo</span> language(<span class="string">"Error code"</span>);<span class="built_in">echo</span> <span class="string">": "</span>.<span class="variable">$output</span>[0];</div><div class="line">        <span class="built_in">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(!file_exists(<span class="variable">$pcap_file_path</span>)) &#123;</div><div class="line">        <span class="built_in">echo</span> <span class="string">"&lt;/br&gt;<span class="variable">$pcap_file_name</span>"</span>;</div><div class="line">        <span class="built_in">echo</span> language(<span class="string">"Can not find"</span>);</div><div class="line">        <span class="built_in">return</span>;</div><div class="line">    &#125;</div><div class="line">    //打开文件  </div><div class="line">    <span class="variable">$fd</span> = fopen (<span class="variable">$pcap_file_path</span>, <span class="string">"r"</span> ); </div><div class="line">    <span class="variable">$size</span> = filesize(<span class="variable">$pcap_file_path</span>) ;</div><div class="line">    //输入文件标签 </div><div class="line">    header(<span class="string">'Content-Encoding: none'</span>);</div><div class="line">    header(<span class="string">'Content-Type: application/force-download'</span>);</div><div class="line">    header(<span class="string">'Content-Type: application/octet-stream'</span>);</div><div class="line">    header(<span class="string">'Content-Type: application/download'</span>);</div><div class="line">    header(<span class="string">'Content-Description: File Transfer'</span>);  </div><div class="line">    header(<span class="string">'Accept-Ranges: bytes'</span>);  </div><div class="line">    header(<span class="string">"Accept-Length: <span class="variable">$size</span>"</span>);  </div><div class="line">    header(<span class="string">'Content-Transfer-Encoding: binary'</span> );</div><div class="line">    header(<span class="string">"Content-Disposition: attachment; filename=<span class="variable">$pcap_file_name</span>"</span> ); </div><div class="line">    header(<span class="string">'Pragma: no-cache'</span>);</div><div class="line">    header(<span class="string">'Expires: 0'</span>);</div><div class="line"></div><div class="line">    //输出文件内容   </div><div class="line">    ob_clean(); //清除输出缓存内容，如果没有的话下载的文件或者压缩包可能是空的</div><div class="line">    flush();    //刷新系统输出缓存</div><div class="line">    <span class="built_in">echo</span> fread(<span class="variable">$fd</span>, <span class="variable">$size</span>);  //读取文件内容并直接输出到浏览器</div><div class="line">    fclose (<span class="variable">$fd</span>);</div><div class="line">    unlink(<span class="variable">$pcap_file_path</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;工作过程中需要将x86设备上的某个文件夹进行打包，然后实现页面下载压缩包的需求。由于工作机上面不支持ZIP工具压缩，于是采用PHP代码嵌入linux tar打包命令实现。&lt;br&gt;PHP代码：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$dir_path&lt;/span&gt; = &lt;span class=&quot;string&quot;&gt;&#39;/disk/report_pdf/&#39;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;exec&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;cd &#39;&lt;/span&gt;.&lt;span class=&quot;variable&quot;&gt;$dir_path&lt;/span&gt;.&lt;span class=&quot;string&quot;&gt;&#39; &amp;amp;&amp;amp; tar -zcvf report.tar.gz -C /disk/report_pdf .&#39;&lt;/span&gt;); &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;// -C参数是解决打包之后带有文件路径的问题，记住最后一定要加 . 。&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Linux,PHP" scheme="http://weibo.com/categories/Linux-PHP/"/>
    
    
  </entry>
  
  <entry>
    <title>原生js去重的方法</title>
    <link href="http://weibo.com/2018/12/06/%E5%8E%9F%E7%94%9Fjs%E5%8E%BB%E9%87%8D%E7%9A%84%E6%96%B9%E6%B3%95/"/>
    <id>http://weibo.com/2018/12/06/原生js去重的方法/</id>
    <published>2018-12-06T12:22:47.000Z</published>
    <updated>2018-12-07T03:27:14.392Z</updated>
    
    <content type="html"><![CDATA[<p>主要写一下前端面试中经常会面到的一个题目，不过在实际开发过程中很少使用原生js去重。<br><a id="more"></a></p>
<h2 id="方法1：循环，比对"><a href="#方法1：循环，比对" class="headerlink" title="方法1：循环，比对"></a>方法1：循环，比对</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">var s = ary.join(<span class="string">","</span>)+<span class="string">","</span>;</div><div class="line"><span class="keyword">for</span>(var i=0;i&lt;ary.length;i++)&#123;</div><div class="line">    <span class="keyword">if</span>(s.replace(ary[i]+<span class="string">","</span>,<span class="string">""</span>).indexOf(ary[i]+<span class="string">","</span>)&gt;-1)&#123;</div><div class="line">        alert(<span class="string">"数组中有重复元素："</span>+ary[i])</div><div class="line">        <span class="built_in">break</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="方法2：排序，循环，比对"><a href="#方法2：排序，循环，比对" class="headerlink" title="方法2：排序，循环，比对"></a>方法2：排序，循环，比对</h2><p>sort() : 返回一个元素已经进行了排序的 Array 对象<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">var ary = new Array(<span class="string">"111"</span>,<span class="string">"22"</span>,<span class="string">"33"</span>,<span class="string">"111"</span>);</div><div class="line">var nary = ary.sort();</div><div class="line"><span class="keyword">for</span>(var i=0;i&lt;ary.length;i++)&#123;</div><div class="line">    <span class="keyword">if</span> (nary[i]==nary[i+1])&#123;</div><div class="line">        alert(<span class="string">"数组重复内容："</span>+nary[i]);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="方法3：定义函数"><a href="#方法3：定义函数" class="headerlink" title="方法3：定义函数"></a>方法3：定义函数</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">function</span> isRepeat(arr)&#123;</div><div class="line">    var <span class="built_in">hash</span> = &#123;&#125;;</div><div class="line">    <span class="keyword">for</span>(var i <span class="keyword">in</span> arr) &#123;</div><div class="line">        <span class="keyword">if</span>(<span class="built_in">hash</span>[arr[i]])</div><div class="line">        <span class="built_in">return</span> <span class="literal">true</span>;</div><div class="line">        <span class="built_in">hash</span>[arr[i]] = <span class="literal">true</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;主要写一下前端面试中经常会面到的一个题目，不过在实际开发过程中很少使用原生js去重。&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://weibo.com/categories/JavaScript/"/>
    
    
  </entry>
  
  <entry>
    <title>解决jQuery表单submit报错的问题</title>
    <link href="http://weibo.com/2018/12/06/%E8%A7%A3%E5%86%B3jQuery%E8%A1%A8%E5%8D%95submit%E6%8A%A5%E9%94%99%E7%9A%84%E9%97%AE%E9%A2%98/"/>
    <id>http://weibo.com/2018/12/06/解决jQuery表单submit报错的问题/</id>
    <published>2018-12-06T12:09:03.000Z</published>
    <updated>2018-12-06T12:20:28.498Z</updated>
    
    <content type="html"><![CDATA[<p>工作过程中遇到表单提交的时候报错，于是在网上了找了找文档，发现如下解决方案，完美解决工作问题：<br><a id="more"></a></p>
<h2 id="问题：解决jquery-submit-提交表单提示-e-h-is-not-a-function"><a href="#问题：解决jquery-submit-提交表单提示-e-h-is-not-a-function" class="headerlink" title="问题：解决jquery submit()提交表单提示 e[h] is not a function"></a>问题：解决jquery submit()提交表单提示 e[h] is not a function</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;form id=<span class="string">"login_form"</span>&gt;</div><div class="line">    &lt;input id=<span class="string">"submits"</span> class=<span class="string">"manlogin"</span> <span class="built_in">type</span>=<span class="string">"submit"</span> value=<span class="string">"登录"</span> /&gt;</div><div class="line">&lt;/form&gt;</div><div class="line">$(<span class="string">"#submits"</span>).click(<span class="function"><span class="title">function</span></span>()&#123;</div><div class="line">    $(<span class="string">"#login_form"</span>).submit();</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="问题原因"><a href="#问题原因" class="headerlink" title="问题原因"></a>问题原因</h3><p>1.form表单中存在type=”submit”的标签,任何js中$(“#login_form”).submit(); 都无效<br>2.当<input id="submits2" class="manlogin" type="button" value="登录123"><br>$(“#submits2”).click(function(){<br>    $(“#login_form”).submit();<br>});<br>这样就会报 e[h] is not a function</p>
<p><input id="submits" class="manlogin" type="sbmit" value="登录"> 提交有效</p>
<h2 id="问题：原生js表单同步提交和提交前操作，以及document-form-submit-is-not-a-function"><a href="#问题：原生js表单同步提交和提交前操作，以及document-form-submit-is-not-a-function" class="headerlink" title="问题：原生js表单同步提交和提交前操作，以及document.form.submit() is not a function"></a>问题：原生js表单同步提交和提交前操作，以及document.form.submit() is not a function</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">    var_dump(<span class="variable">$_POST</span>);   //var_dump打印变量的相关信息</div><div class="line">?&gt;</div><div class="line">&lt;html&gt;</div><div class="line">&lt;body&gt;</div><div class="line">&lt;script language=<span class="string">"javascript"</span>&gt;</div><div class="line">    <span class="keyword">function</span> SendForm () </div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(CheckPost()) </div><div class="line">        &#123;</div><div class="line">            document.addForm.submit();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    <span class="keyword">function</span> CheckPost () </div><div class="line">    &#123;</div><div class="line">         <span class="keyword">if</span> (addForm.user.value == <span class="string">""</span>) </div><div class="line">         &#123;</div><div class="line">               alert(<span class="string">"请填写用户名！"</span>);</div><div class="line">               addForm.username.focus();</div><div class="line">               <span class="built_in">return</span> <span class="literal">false</span>;</div><div class="line">         &#125;</div><div class="line">         <span class="keyword">if</span> (addForm.title.value.length &lt; 5) </div><div class="line">         &#123;</div><div class="line">               alert(<span class="string">"标题不能少于5个字符！"</span>);</div><div class="line">               addForm.title.focus();</div><div class="line">               <span class="built_in">return</span> <span class="literal">false</span>;</div><div class="line">         &#125;</div><div class="line">         <span class="built_in">return</span> <span class="literal">true</span>;</div><div class="line">    &#125;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;form action=<span class="string">"test.php"</span> method=<span class="string">"post"</span> name=<span class="string">"addForm"</span>&gt;</div><div class="line">     &lt;div&gt;用户:&lt;input <span class="built_in">type</span>=<span class="string">"text"</span> size=<span class="string">"10"</span> name=<span class="string">"user"</span> maxlength=<span class="string">"20"</span>/&gt;&lt;/div&gt;</div><div class="line">     &lt;div&gt;标题:&lt;input <span class="built_in">type</span>=<span class="string">"text"</span> name=<span class="string">"title"</span> maxlength=<span class="string">"50"</span>/&gt;&lt;/div&gt;</div><div class="line">     &lt;div&gt;内容:&lt;textarea name=<span class="string">"content"</span> rows=<span class="string">"8"</span> cols=<span class="string">"30"</span>&gt;&lt;/textarea&gt;&lt;/div&gt;</div><div class="line">     &lt;div&gt;&lt;input <span class="built_in">type</span>=<span class="string">"button"</span> name=<span class="string">"submit"</span> value=”发表” onclick=<span class="string">"SendForm();"</span>/&gt;&lt;/div&gt;</div><div class="line">&lt;/form&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<h3 id="问题原因："><a href="#问题原因：" class="headerlink" title="问题原因："></a>问题原因：</h3><p>当表单<form>…</form>中含有name=”submit”时，提交时就会有冲突，这个错误常见于按钮上，如:<br>在javascript做submit()的时候就会出现冲突，这时将name=”submit”改成别的比如login之类的就可以了，反正submit在这个情况下是个保留关键字。<br>在表单的输入框中使用了<input name="submit" type="text">，这样也是不行的。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;工作过程中遇到表单提交的时候报错，于是在网上了找了找文档，发现如下解决方案，完美解决工作问题：&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="jQuery" scheme="http://weibo.com/categories/jQuery/"/>
    
    
  </entry>
  
  <entry>
    <title>PHP获取今日/昨日/上周/本月的起始时间戳和结束时间戳的方法</title>
    <link href="http://weibo.com/2018/12/06/PHP%E8%8E%B7%E5%8F%96%E4%BB%8A%E6%97%A5-%E6%98%A8%E6%97%A5-%E4%B8%8A%E5%91%A8-%E6%9C%AC%E6%9C%88%E7%9A%84%E8%B5%B7%E5%A7%8B%E6%97%B6%E9%97%B4%E6%88%B3%E5%92%8C%E7%BB%93%E6%9D%9F%E6%97%B6%E9%97%B4%E6%88%B3%E7%9A%84%E6%96%B9%E6%B3%95/"/>
    <id>http://weibo.com/2018/12/06/PHP获取今日-昨日-上周-本月的起始时间戳和结束时间戳的方法/</id>
    <published>2018-12-06T11:50:09.000Z</published>
    <updated>2018-12-06T12:07:27.619Z</updated>
    
    <content type="html"><![CDATA[<p>php 获取今日、昨日、上周、本月的起始时间戳和结束时间戳的方法，主要使用到了 php 的时间函数 mktime。<br><a id="more"></a></p>
<h2 id="php获取今日开始时间戳和结束时间戳"><a href="#php获取今日开始时间戳和结束时间戳" class="headerlink" title="php获取今日开始时间戳和结束时间戳"></a>php获取今日开始时间戳和结束时间戳</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$beginToday</span> = mktime(0,0,0,date(<span class="string">'m'</span>),date(<span class="string">'d'</span>),date(<span class="string">'Y'</span>));</div><div class="line"><span class="variable">$endToday</span> = mktime(0,0,0,date(<span class="string">'m'</span>),date(<span class="string">'d'</span>)+1,date(<span class="string">'Y'</span>))-1;</div></pre></td></tr></table></figure>
<h2 id="php获取昨日开始时间戳和结束时间戳"><a href="#php获取昨日开始时间戳和结束时间戳" class="headerlink" title="php获取昨日开始时间戳和结束时间戳"></a>php获取昨日开始时间戳和结束时间戳</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$beginYesterday</span> = mktime(0,0,0,date(<span class="string">'m'</span>),date(<span class="string">'d'</span>)-1,date(<span class="string">'Y'</span>));</div><div class="line"><span class="variable">$endYesterday</span> = mktime(0,0,0,date(<span class="string">'m'</span>),date(<span class="string">'d'</span>),date(<span class="string">'Y'</span>))-1;</div></pre></td></tr></table></figure>
<h2 id="php获取上周起始时间戳和结束时间戳"><a href="#php获取上周起始时间戳和结束时间戳" class="headerlink" title="php获取上周起始时间戳和结束时间戳"></a>php获取上周起始时间戳和结束时间戳</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$beginLastweek</span>=mktime(0,0,0,date(<span class="string">'m'</span>),date(<span class="string">'d'</span>)-date(<span class="string">'w'</span>)+1-7,date(<span class="string">'Y'</span>));</div><div class="line">// date(<span class="string">"Y-m-d H:i:s"</span>,mktime(0, 0 , 0,date(<span class="string">"m"</span>),date(<span class="string">"d"</span>)-date(<span class="string">"w"</span>)+1-7,date(<span class="string">"Y"</span>)));</div><div class="line"><span class="variable">$endLastweek</span>=mktime(23,59,59,date(<span class="string">'m'</span>),date(<span class="string">'d'</span>)-date(<span class="string">'w'</span>)+7-7,date(<span class="string">'Y'</span>));</div><div class="line">// date(<span class="string">"Y-m-d H:i:s"</span>,mktime(23,59,59,date(<span class="string">"m"</span>),date(<span class="string">"d"</span>)-date(<span class="string">"w"</span>)+7-7,date(<span class="string">"Y"</span>)));</div></pre></td></tr></table></figure>
<h2 id="php获取本月起始时间戳和结束时间戳"><a href="#php获取本月起始时间戳和结束时间戳" class="headerlink" title="php获取本月起始时间戳和结束时间戳"></a>php获取本月起始时间戳和结束时间戳</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$beginThismonth</span>=mktime(0,0,0,date(<span class="string">'m'</span>),1,date(<span class="string">'Y'</span>));</div><div class="line"><span class="variable">$endThismonth</span>=mktime(23,59,59,date(<span class="string">'m'</span>),date(<span class="string">'t'</span>),date(<span class="string">'Y'</span>));</div></pre></td></tr></table></figure>
<h2 id="PHP-mktime-函数用于返回一个日期的-Unix-时间戳。"><a href="#PHP-mktime-函数用于返回一个日期的-Unix-时间戳。" class="headerlink" title="PHP mktime() 函数用于返回一个日期的 Unix 时间戳。"></a>PHP mktime() 函数用于返回一个日期的 Unix 时间戳。</h2><p>语法:<br>mktime(hour,minute,second,month,day,year,is_dst)</p>
<h2 id="获取今天00-00"><a href="#获取今天00-00" class="headerlink" title="获取今天00:00"></a>获取今天00:00</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$todaystart</span> = strtotime(date(<span class="string">'Y-m-d'</span>.<span class="string">'00:00:00'</span>,time()));</div></pre></td></tr></table></figure>
<h2 id="获取今天24-00"><a href="#获取今天24-00" class="headerlink" title="获取今天24:00"></a>获取今天24:00</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$todayend</span> = strtotime(date(<span class="string">'Y-m-d'</span>.<span class="string">'00:00:00'</span>,time()+3600*24));</div></pre></td></tr></table></figure>
<h2 id="统计今天注册的用户"><a href="#统计今天注册的用户" class="headerlink" title="统计今天注册的用户"></a>统计今天注册的用户</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$todayuser</span>[<span class="string">'create_time'</span>] = array(between,<span class="string">"<span class="variable">$todaystart</span>,<span class="variable">$todayend</span>"</span>);</div><div class="line"><span class="variable">$todaysum</span> = <span class="variable">$Users</span>-&gt;<span class="built_in">where</span>(<span class="variable">$todayuser</span>)-&gt;count();</div></pre></td></tr></table></figure>
<h2 id="获取昨天00-00"><a href="#获取昨天00-00" class="headerlink" title="获取昨天00:00"></a>获取昨天00:00</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$timestart</span> = strtotime(date(<span class="string">'Y-m-d'</span>.<span class="string">'00:00:00'</span>,time()-3600*24));</div></pre></td></tr></table></figure>
<h2 id="获取今天00-00-1"><a href="#获取今天00-00-1" class="headerlink" title="获取今天00:00"></a>获取今天00:00</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$timeend</span> = strtotime(date(<span class="string">'Y-m-d'</span>.<span class="string">'00:00:00'</span>,time()));</div></pre></td></tr></table></figure>
<h2 id="统计昨天注册的用户"><a href="#统计昨天注册的用户" class="headerlink" title="统计昨天注册的用户"></a>统计昨天注册的用户</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$map</span>[<span class="string">'create_time'</span>] = array(between,<span class="string">"<span class="variable">$timestart</span>,<span class="variable">$timeend</span>"</span>);</div><div class="line"><span class="variable">$daycount</span> = <span class="variable">$Users</span>-&gt;<span class="built_in">where</span>(<span class="variable">$map</span>)-&gt;count();</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$this</span>-&gt;assign(<span class="string">"todaysum"</span>,<span class="variable">$todaysum</span>);</div><div class="line"><span class="variable">$this</span>-&gt;assign(<span class="string">"daycount"</span>,<span class="variable">$daycount</span>);</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;php 获取今日、昨日、上周、本月的起始时间戳和结束时间戳的方法，主要使用到了 php 的时间函数 mktime。&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="PHP" scheme="http://weibo.com/categories/PHP/"/>
    
    
  </entry>
  
  <entry>
    <title>Linux下开启SSH</title>
    <link href="http://weibo.com/2018/12/06/Linux%E4%B8%8B%E5%BC%80%E5%90%AFSSH/"/>
    <id>http://weibo.com/2018/12/06/Linux下开启SSH/</id>
    <published>2018-12-06T10:24:28.000Z</published>
    <updated>2018-12-06T10:38:58.973Z</updated>
    
    <content type="html"><![CDATA[<p>发现PhpStorm通过sftp上传文件的时候一直上传失败，后来发现是因为ssh不允许root用户远程登录。</p>
<h2 id="1、允许root用户远程登录"><a href="#1、允许root用户远程登录" class="headerlink" title="1、允许root用户远程登录"></a>1、允许root用户远程登录</h2><p>修改ssh服务配置文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vi /etc/ssh/sshd_config</div></pre></td></tr></table></figure></p>
<p>调整PermitRootLogin参数值为yes</p>
<h2 id="2、允许无密码登录"><a href="#2、允许无密码登录" class="headerlink" title="2、允许无密码登录"></a>2、允许无密码登录</h2><p>同上，修改ssh服务配置文件，两种情况：<br>1） 将PermitEmptyPasswords yes前面的#号去掉<br>2） 将PermitEmptyPasswords 参数值修改为yes</p>
<h2 id="以上两种配置，均需要重启ssh服务"><a href="#以上两种配置，均需要重启ssh服务" class="headerlink" title="以上两种配置，均需要重启ssh服务"></a>以上两种配置，均需要重启ssh服务</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">service sshd restart  //或者</div><div class="line">/etc/init.d/ssh restart //或者</div><div class="line">/etc/init.d/sshd restart</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;发现PhpStorm通过sftp上传文件的时候一直上传失败，后来发现是因为ssh不允许root用户远程登录。&lt;/p&gt;
&lt;h2 id=&quot;1、允许root用户远程登录&quot;&gt;&lt;a href=&quot;#1、允许root用户远程登录&quot; class=&quot;headerlink&quot; title=&quot;1、
    
    </summary>
    
      <category term="Linux" scheme="http://weibo.com/categories/Linux/"/>
    
    
  </entry>
  
  <entry>
    <title>开启/关闭ubuntu防火墙</title>
    <link href="http://weibo.com/2018/12/06/%E5%BC%80%E5%90%AF-%E5%85%B3%E9%97%ADubuntu%E9%98%B2%E7%81%AB%E5%A2%99/"/>
    <id>http://weibo.com/2018/12/06/开启-关闭ubuntu防火墙/</id>
    <published>2018-12-06T03:46:21.000Z</published>
    <updated>2018-12-06T04:17:57.854Z</updated>
    
    <content type="html"><![CDATA[<h2 id="安装防火墙"><a href="#安装防火墙" class="headerlink" title="安装防火墙"></a>安装防火墙</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install ufw</div></pre></td></tr></table></figure>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><h3 id="1、启用"><a href="#1、启用" class="headerlink" title="1、启用"></a>1、启用</h3><p>sudo ufw enable<br>sudo ufw default deny<br>作用：开启了防火墙并随系统启动同时关闭所有外部对本机的访问（本机访问外部正常）。</p>
<h3 id="2、关闭"><a href="#2、关闭" class="headerlink" title="2、关闭"></a>2、关闭</h3><p>sudo ufw disable </p>
<h3 id="3、查看防火墙状态"><a href="#3、查看防火墙状态" class="headerlink" title="3、查看防火墙状态"></a>3、查看防火墙状态</h3><p>sudo ufw status </p>
<h3 id="4、开启-禁用相应端口或服务举例"><a href="#4、开启-禁用相应端口或服务举例" class="headerlink" title="4、开启/禁用相应端口或服务举例"></a>4、开启/禁用相应端口或服务举例</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">sudo ufw allow 80 允许外部访问80端口</div><div class="line">sudo ufw delete allow 80 禁止外部访问80 端口</div><div class="line">sudo ufw allow from 192.168.1.1 允许此IP访问所有的本机端口</div><div class="line">sudo ufw deny smtp 禁止外部访问smtp服务</div><div class="line">sudo ufw delete allow smtp 删除上面建立的某条规则</div><div class="line">sudo ufw deny proto tcp from 10.0.0.0/8 to 192.168.0.1 port 22 要拒绝所有的TCP流量从10.0.0.0/8 到192.168.0.1地址的22端口</div><div class="line"> </div><div class="line">可以允许所有RFC1918网络（局域网/无线局域网的）访问这个主机（/8,/16,/12是一种网络分级）：</div><div class="line">sudo ufw allow from 10.0.0.0/8</div><div class="line">sudo ufw allow from 172.16.0.0/12</div><div class="line">sudo ufw allow from 192.168.0.0/16</div></pre></td></tr></table></figure>
<p>推荐设置<br>sudo apt-get install ufw<br>sudo ufw enable<br>sudo ufw default deny </p>
<p>这样设置已经很安全，如果有特殊需要，可以使用sudo ufw allow开启相应服务。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;安装防火墙&quot;&gt;&lt;a href=&quot;#安装防火墙&quot; class=&quot;headerlink&quot; title=&quot;安装防火墙&quot;&gt;&lt;/a&gt;安装防火墙&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://weibo.com/categories/Linux/"/>
    
    
  </entry>
  
  <entry>
    <title>Ubuntu14.04使用qemu创建虚拟机并配置桥接网络</title>
    <link href="http://weibo.com/2018/12/06/Ubuntu14-04%E4%BD%BF%E7%94%A8qemu%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B9%B6%E9%85%8D%E7%BD%AE%E6%A1%A5%E6%8E%A5%E7%BD%91%E7%BB%9C/"/>
    <id>http://weibo.com/2018/12/06/Ubuntu14-04使用qemu创建虚拟机并配置桥接网络/</id>
    <published>2018-12-06T03:05:40.000Z</published>
    <updated>2018-12-06T04:21:51.790Z</updated>
    
    <content type="html"><![CDATA[<p>需要在宿主机中为虚拟机创建一个</p>
<h5 id="tap虚拟网络接口，"><a href="#tap虚拟网络接口，" class="headerlink" title="tap虚拟网络接口，"></a>tap虚拟网络接口，</h5><p>并创建一个</p>
<h5 id="虚拟网桥br0，"><a href="#虚拟网桥br0，" class="headerlink" title="虚拟网桥br0，"></a>虚拟网桥br0，</h5><p>并将tap和br0桥接起来就可以实现虚拟机的网络了。<br><a id="more"></a><br>配置的步骤：</p>
<h2 id="一、安装两个配置网络所需软件包"><a href="#一、安装两个配置网络所需软件包" class="headerlink" title="一、安装两个配置网络所需软件包"></a>一、安装两个配置网络所需软件包</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># apt-get install bridge-utils        // 虚拟网桥工具</span></div><div class="line"><span class="comment"># apt-get install uml-utilities       // UML（User-mode linux）工具</span></div></pre></td></tr></table></figure>
<h2 id="二、配置虚拟网桥br0"><a href="#二、配置虚拟网桥br0" class="headerlink" title="二、配置虚拟网桥br0"></a>二、配置虚拟网桥br0</h2><p>修改网络配置文件 vi /etc/network/interfaces<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">auto lo</div><div class="line">iface lo inet loopback</div><div class="line"></div><div class="line">auto br0</div><div class="line">iface br0 inet static</div><div class="line">        bridge_ports eth0</div><div class="line">address 192.168.199.186</div><div class="line">netmask 255.255.255.0</div><div class="line">gateway 192.168.199.1</div><div class="line">dns-nameserver 8.8.8.8</div><div class="line">bridge_fd 9</div><div class="line">bridge_hello 2</div><div class="line">bridge_maxage 12</div><div class="line">bridge_stp off</div><div class="line"></div><div class="line">auto eth0</div><div class="line">iface eth0 inet static</div><div class="line">address 192.168.199.186</div><div class="line">netmask 255.255.255.0</div><div class="line">gateway 192.168.199.1</div><div class="line">dns-nameserver 8.8.8.8</div></pre></td></tr></table></figure></p>
<p>在适当的位置填上你的环境对应的参数。<br>配置完成之后一定要重启，不然看不到创建的虚拟网桥。</p>
<h2 id="三、手动配置TAP设备的操作"><a href="#三、手动配置TAP设备的操作" class="headerlink" title="三、手动配置TAP设备的操作"></a>三、手动配置TAP设备的操作</h2><p>(最下面有通过interfaces文件在服务器启动时自动配置TAP的步骤)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">tunctl -t tap0 -u root              // 创建一个tap0接口，只允许root用户访问</div><div class="line">brctl addif br0 tap0                // 在虚拟网桥中增加一个tap0接口</div><div class="line">ifconfig tap0 0.0.0.0 promisc up    // 打开tap0接口</div><div class="line">brctl showstp br0                   // 显示br0的各个接口</div></pre></td></tr></table></figure></p>
<h2 id="四、启动虚拟机"><a href="#四、启动虚拟机" class="headerlink" title="四、启动虚拟机"></a>四、启动虚拟机</h2><h2 id="五、修改虚拟机的网络配置文件"><a href="#五、修改虚拟机的网络配置文件" class="headerlink" title="五、修改虚拟机的网络配置文件"></a>五、修改虚拟机的网络配置文件</h2><p>vi /etc/network/interfaces<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">auto lo</div><div class="line">iface lo inet loopback</div><div class="line"></div><div class="line">auto eth0</div><div class="line">iface eth0 inet static</div><div class="line">address 192.168.199.187</div><div class="line">netmask 255.255.255.0</div><div class="line">gateway 192.168.199.1</div><div class="line">bridge_fp 9</div><div class="line">bridge_hello 2</div><div class="line">bridge_maxage 12</div><div class="line">bridge_stp off</div><div class="line">dns-nameserver 8.8.8.8</div></pre></td></tr></table></figure></p>
<p>修改完成之后ifdown eth0 &amp;&amp; ifup eth0 或者重启虚拟机</p>
<h2 id="六、为了在系统启动时能够自动配置虚拟网桥和TAP设备，编写"><a href="#六、为了在系统启动时能够自动配置虚拟网桥和TAP设备，编写" class="headerlink" title="六、为了在系统启动时能够自动配置虚拟网桥和TAP设备，编写"></a>六、为了在系统启动时能够自动配置虚拟网桥和TAP设备，编写</h2><p>vi /etc/network/interfaces<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">auto lo</div><div class="line">iface lo inet loopback</div><div class="line"><span class="comment"># auto eth0 //eth0网卡的配置要注释掉</span></div><div class="line"><span class="comment"># iface eth0 inet manual</span></div><div class="line">auto br0</div><div class="line">iface br0 inet static</div><div class="line">        bridge_ports eth0</div><div class="line">address 192.168.199.186</div><div class="line">netmask 255.255.255.0</div><div class="line">gateway 192.168.199.1</div><div class="line">bridge_fd 9</div><div class="line">bridge_hello 2</div><div class="line">bridge_maxage 12</div><div class="line">bridge_stp off</div><div class="line">dns-nameservers 8.8.8.8 114.114.114.114</div><div class="line">auto tap0</div><div class="line">iface tap0 inet manual</div><div class="line">pre-up tunctl -t tap0 -u root</div><div class="line">pre-up ifconfig tap0 0.0.0.0 promisc up</div><div class="line">post-up brctl addif br0 tap0</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;需要在宿主机中为虚拟机创建一个&lt;/p&gt;
&lt;h5 id=&quot;tap虚拟网络接口，&quot;&gt;&lt;a href=&quot;#tap虚拟网络接口，&quot; class=&quot;headerlink&quot; title=&quot;tap虚拟网络接口，&quot;&gt;&lt;/a&gt;tap虚拟网络接口，&lt;/h5&gt;&lt;p&gt;并创建一个&lt;/p&gt;
&lt;h5 id=&quot;虚拟网桥br0，&quot;&gt;&lt;a href=&quot;#虚拟网桥br0，&quot; class=&quot;headerlink&quot; title=&quot;虚拟网桥br0，&quot;&gt;&lt;/a&gt;虚拟网桥br0，&lt;/h5&gt;&lt;p&gt;并将tap和br0桥接起来就可以实现虚拟机的网络了。&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://weibo.com/categories/Linux/"/>
    
    
  </entry>
  
  <entry>
    <title>在Ubuntu中安装和使用kvm</title>
    <link href="http://weibo.com/2018/12/05/%E5%9C%A8Ubuntu%E4%B8%AD%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8kvm/"/>
    <id>http://weibo.com/2018/12/05/在Ubuntu中安装和使用kvm/</id>
    <published>2018-12-05T04:43:30.000Z</published>
    <updated>2018-12-07T03:26:56.433Z</updated>
    
    <content type="html"><![CDATA[<p>首先解决设备不能上网的问题：<br>手动设置静态IP<br>1、vim /etc/network/interfaces</p>
<p>2、修改文件内容<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">auto lo</div><div class="line">iface lo inet loopback</div><div class="line"></div><div class="line">auto eth0</div><div class="line">iface eth0 inet static</div><div class="line">address 192.168.199.186</div><div class="line">netmask 255.255.255.0</div><div class="line">gateway 192.168.199.1</div><div class="line">dns-nameserver 8.8.8.8</div></pre></td></tr></table></figure></p>
<p>3、配置DNS解析器<br>vim /etc/reslov.conf，输入<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">nameserver 8.8.8.8  //(8.8.8.8谷歌的DNS解析器，可能比较慢)</div><div class="line">nameserver 114.114.114.114  //(国内的DNS解析器)</div></pre></td></tr></table></figure></p>
<p>但是Ubuntu Server 中resolv.conf重启时会被覆盖，解决方法如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">1.需要创建一个文件/etc/resolvconf/resolv.conf.d/tail</div><div class="line">sudo vi /etc/resolvconf/resolv.conf.d/tail</div><div class="line"></div><div class="line">2.在该文件中写入自己需要的dns服务器，格式与/etc/resolv.conf相同</div><div class="line">nameserver 8.8.8.8  </div><div class="line"></div><div class="line">3.重启下resolvconf程序</div><div class="line">sudo /etc/init.d/resolvconf restart </div><div class="line"></div><div class="line">再去看看/etc/resolv.conf文件,可以看到自己添加的dns服务器已经加到该文件中</div></pre></td></tr></table></figure></p>
<p>4、重启网络sudo /etc/init.d/networking restart<br>   重启网卡还有以下几种方法：</p>
<a id="more"></a>
<h2 id="Linux重启网卡的三种方法"><a href="#Linux重启网卡的三种方法" class="headerlink" title="Linux重启网卡的三种方法"></a>Linux重启网卡的三种方法</h2><h3 id="一、network"><a href="#一、network" class="headerlink" title="一、network"></a>一、network</h3><p>利用root帐户<br>service network restart<br>或者/etc/init.d/networking restart</p>
<h3 id="二、ifdown-ifup"><a href="#二、ifdown-ifup" class="headerlink" title="二、ifdown/ifup"></a>二、ifdown/ifup</h3><p>ifdown eth0<br>ifup eth0</p>
<h3 id="三、ifconfig"><a href="#三、ifconfig" class="headerlink" title="三、ifconfig"></a>三、ifconfig</h3><p>ifconfig eth0 down<br>ifconfig eth0 up</p>
<h3 id="四、重启失效"><a href="#四、重启失效" class="headerlink" title="四、重启失效"></a>四、重启失效</h3><p>Ubuntu14.04修改配置，重启网卡没有生效，出现如下问题：<br>service  networking restart //重启网络服务<br>stop: Job failed while stopping<br>start: Job is already running: networking</p>
<p>tail -f /var/log/upstart/networking.log //查看错误日志<br>Stopping or restarting the networking job is notsupported.<br>Use ifdown &amp; ifup to reconfigure desired interface.</p>
<p>从以上日志内容可以看出，传统的service重启和停止网络已经不再支持了，需要通过使用ifdown &amp;ifup来实现相应的操作。<br>重启指定网卡：<br>ifdown eth0 &amp;&amp; ifup eth0</p>
<h2 id="su命令不能切换root的问题"><a href="#su命令不能切换root的问题" class="headerlink" title="su命令不能切换root的问题"></a>su命令不能切换root的问题</h2><p>提示su: Authentication failure，只要你sudo passwd root过一次之后，下次再su的时候只要输入密码就可以成功登录了。</p>
<h2 id="Ubuntu安装kvm"><a href="#Ubuntu安装kvm" class="headerlink" title="Ubuntu安装kvm"></a>Ubuntu安装kvm</h2><h3 id="一、安装KVM前的检测工作：检测电脑CPU是否支持虚拟化"><a href="#一、安装KVM前的检测工作：检测电脑CPU是否支持虚拟化" class="headerlink" title="一、安装KVM前的检测工作：检测电脑CPU是否支持虚拟化"></a>一、安装KVM前的检测工作：检测电脑CPU是否支持虚拟化</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># egrep -c '(vmx|svm)' /proc/cpuinfo</span></div></pre></td></tr></table></figure>
<p>输出结果为0,不支持<br>输出结果大于0,支持</p>
<h3 id="二、使用root用户给当前用户增加sudo的权限，避免在安装是需要输入root密码"><a href="#二、使用root用户给当前用户增加sudo的权限，避免在安装是需要输入root密码" class="headerlink" title="二、使用root用户给当前用户增加sudo的权限，避免在安装是需要输入root密码"></a>二、使用root用户给当前用户增加sudo的权限，避免在安装是需要输入root密码</h3><p>输入如下命令:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">echo</span> <span class="string">"zhy ALL=(ALL) ALL"</span> &gt;&gt;/etc/sudoers</div><div class="line"><span class="built_in">echo</span> <span class="string">"zhy ALL=(ALL) NOPASSWD:ALL"</span> &gt;&gt;/etc/sudoers</div></pre></td></tr></table></figure></p>
<p>其中zhy是用户名</p>
<h3 id="三、重新登录Ubuntu，验证sudo权限"><a href="#三、重新登录Ubuntu，验证sudo权限" class="headerlink" title="三、重新登录Ubuntu，验证sudo权限"></a>三、重新登录Ubuntu，验证sudo权限</h3><p>输入sudo apt-get update命令，如果没有提示要求输入密码则表示设置sudo权限成功</p>
<h3 id="四、安装KVM程序包"><a href="#四、安装KVM程序包" class="headerlink" title="四、安装KVM程序包"></a>四、安装KVM程序包</h3><p>root权限下输入命令：<br>sudo apt-get install qemu-kvm libvirt-bin ubuntu-vm-builder bridge-utils<br>安装完成后需要重新登录系统，输入命令groups，确保用户已经加入libvirtd群组中</p>
<h4 id="踩坑-Ubuntu不支持yum安装kvm，适用于CentOS。"><a href="#踩坑-Ubuntu不支持yum安装kvm，适用于CentOS。" class="headerlink" title="踩坑 || Ubuntu不支持yum安装kvm，适用于CentOS。"></a>踩坑 || Ubuntu不支持yum安装kvm，适用于CentOS。</h4><p><a href="https://www.cnblogs.com/lk-fxtx/p/7692773.html" target="_blank" rel="external">参见文档</a></p>
<h3 id="五、验证KVM安装是否成功"><a href="#五、验证KVM安装是否成功" class="headerlink" title="五、验证KVM安装是否成功"></a>五、验证KVM安装是否成功</h3><p>输入命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">virsh list --all</div></pre></td></tr></table></figure></p>
<p>如果没有错误提示则安装成功</p>
<h3 id="六、安装KVM虚拟机GUI管理工具"><a href="#六、安装KVM虚拟机GUI管理工具" class="headerlink" title="六、安装KVM虚拟机GUI管理工具"></a>六、安装KVM虚拟机GUI管理工具</h3><p>root权限下输入命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># apt-get install virt-manager</span></div></pre></td></tr></table></figure></p>
<h4 id="踩坑-virt-manager-linux上虚拟机安装错误处理："><a href="#踩坑-virt-manager-linux上虚拟机安装错误处理：" class="headerlink" title="踩坑 || virt-manager linux上虚拟机安装错误处理："></a>踩坑 || virt-manager linux上虚拟机安装错误处理：</h4><p>error: Failed to connect socket to ‘/var/run/libvirt/libvirt-sock’: No such file or directory</p>
<h5 id="1、换成ustc的源，-其他的源请自查"><a href="#1、换成ustc的源，-其他的源请自查" class="headerlink" title="1、换成ustc的源，(其他的源请自查)"></a>1、换成ustc的源，(其他的源请自查)</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vi /etc/apt/sources.list</div></pre></td></tr></table></figure>
<p>修改文件：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">deb http://debian.ustc.edu.cn/debian stable main non-free contrib</div><div class="line">deb-src http://debian.ustc.edu.cn/debian stable main non-free contrib</div><div class="line">deb http://debian.ustc.edu.cn/debian proposed-updates main contrib non-free</div><div class="line">deb-src http://debian.ustc.edu.cn/debian proposed-updates main contrib non-free</div><div class="line">deb http://debian.ustc.edu.cn/debian-security stable/updates main</div><div class="line"></div><div class="line">deb https://mirrors.ustc.edu.cn/ubuntu/ xenial main restricted universe multiverse</div><div class="line"><span class="comment"># deb-src https://mirrors.ustc.edu.cn/ubuntu/ xenial main main restricted universe multiverse</span></div><div class="line">deb https://mirrors.ustc.edu.cn/ubuntu/ xenial-updates main restricted universe multiverse</div><div class="line"><span class="comment"># deb-src https://mirrors.ustc.edu.cn/ubuntu/ xenial-updates main restricted universe multiverse</span></div><div class="line">deb https://mirrors.ustc.edu.cn/ubuntu/ xenial-backports main restricted universe multiverse</div><div class="line"><span class="comment"># deb-src https://mirrors.ustc.edu.cn/ubuntu/ xenial-backports main restricted universe multiverse</span></div><div class="line">deb https://mirrors.ustc.edu.cn/ubuntu/ xenial-security main restricted universe multiverse</div><div class="line"><span class="comment"># deb-src https://mirrors.ustc.edu.cn/ubuntu/ xenial-security main restricted universe multiverse</span></div></pre></td></tr></table></figure></p>
<h5 id="2、安装kvm"><a href="#2、安装kvm" class="headerlink" title="2、安装kvm"></a>2、安装kvm</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install kvm</div></pre></td></tr></table></figure>
<h5 id="3、卸载virt-manager-再安装一遍"><a href="#3、卸载virt-manager-再安装一遍" class="headerlink" title="3、卸载virt-manager .再安装一遍"></a>3、卸载virt-manager .再安装一遍</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo apt-get autoremove virt-manager   //卸载</div><div class="line">sudo apt-get install virt-manager   //安装</div></pre></td></tr></table></figure>
<h5 id="4、去-var-run-libvirt-给-libvirt-sock-libvirt-sock-ro-virtlockd-sock-这三个文件加权限"><a href="#4、去-var-run-libvirt-给-libvirt-sock-libvirt-sock-ro-virtlockd-sock-这三个文件加权限" class="headerlink" title="4、去 /var/run/libvirt  给 libvirt-sock  libvirt-sock-ro virtlockd-sock 这三个文件加权限"></a>4、去 /var/run/libvirt  给 libvirt-sock  libvirt-sock-ro virtlockd-sock 这三个文件加权限</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sudo chmod -R 777 libvirt-sock</div><div class="line">sudo chmod -R 777 libvirt-sock-ro </div><div class="line">sudo chmod -R 777 virtlockd-sock</div></pre></td></tr></table></figure>
<h5 id="5、重启服务"><a href="#5、重启服务" class="headerlink" title="5、重启服务"></a>5、重启服务</h5><p>service libvirtd restart</p>
<h3 id="七、使用虚拟机GUI管理工具创建虚拟机"><a href="#七、使用虚拟机GUI管理工具创建虚拟机" class="headerlink" title="七、使用虚拟机GUI管理工具创建虚拟机"></a>七、使用虚拟机GUI管理工具创建虚拟机</h3><p>搜索Virtual Machine Manager,打开虚拟机管理工具进行虚拟机的创建<br>创建虚拟机时使用准备好的iso文件，然后按照说明Forward</p>
<h2 id="Xshell连接不上Ubuntu的问题"><a href="#Xshell连接不上Ubuntu的问题" class="headerlink" title="Xshell连接不上Ubuntu的问题"></a>Xshell连接不上Ubuntu的问题</h2><p>通常报错: … … (port:22): connection failed.<br>原因：没有真正开启ssh-server服务<br>解决方法：</p>
<h3 id="一、安装ssh-server服务"><a href="#一、安装ssh-server服务" class="headerlink" title="一、安装ssh-server服务"></a>一、安装ssh-server服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install openssh-server</div></pre></td></tr></table></figure>
<h3 id="二、确认ssh-server是否启动"><a href="#二、确认ssh-server是否启动" class="headerlink" title="二、确认ssh-server是否启动"></a>二、确认ssh-server是否启动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ps -e |grep ssh</div></pre></td></tr></table></figure>
<h3 id="三、启动ssh"><a href="#三、启动ssh" class="headerlink" title="三、启动ssh"></a>三、启动ssh</h3><p>如果只有ssh-agent，表示ssh-server还没有启动，需要：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/etc/init.d/ssh start</div></pre></td></tr></table></figure></p>
<p>如果看到sshd，则ssh-server已经启动了。</p>
<h3 id="四、补充"><a href="#四、补充" class="headerlink" title="四、补充"></a>四、补充</h3><p>ssh-server配置文件位于：<br>/etc/ssh/sshd_config<br>在这里可以定义SSH的服务端口，默认端口是22，你可以自己定义成其他端口号，<br>如21。然后重启SSH服务：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo /etc/init.d/ssh resart</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;首先解决设备不能上网的问题：&lt;br&gt;手动设置静态IP&lt;br&gt;1、vim /etc/network/interfaces&lt;/p&gt;
&lt;p&gt;2、修改文件内容&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;auto lo&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;iface lo inet loopback&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;auto eth0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;iface eth0 inet static&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;address 192.168.199.186&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;netmask 255.255.255.0&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;gateway 192.168.199.1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;dns-nameserver 8.8.8.8&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;3、配置DNS解析器&lt;br&gt;vim /etc/reslov.conf，输入&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;nameserver 8.8.8.8  //(8.8.8.8谷歌的DNS解析器，可能比较慢)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;nameserver 114.114.114.114  //(国内的DNS解析器)&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;但是Ubuntu Server 中resolv.conf重启时会被覆盖，解决方法如下：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1.需要创建一个文件/etc/resolvconf/resolv.conf.d/tail&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sudo vi /etc/resolvconf/resolv.conf.d/tail&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2.在该文件中写入自己需要的dns服务器，格式与/etc/resolv.conf相同&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;nameserver 8.8.8.8  &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3.重启下resolvconf程序&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sudo /etc/init.d/resolvconf restart &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;再去看看/etc/resolv.conf文件,可以看到自己添加的dns服务器已经加到该文件中&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;4、重启网络sudo /etc/init.d/networking restart&lt;br&gt;   重启网卡还有以下几种方法：&lt;/p&gt;
    
    </summary>
    
      <category term="linux" scheme="http://weibo.com/categories/linux/"/>
    
    
  </entry>
  
  <entry>
    <title>Webpack</title>
    <link href="http://weibo.com/2018/12/04/Webpack/"/>
    <id>http://weibo.com/2018/12/04/Webpack/</id>
    <published>2018-12-04T11:13:56.000Z</published>
    <updated>2018-12-04T11:25:11.581Z</updated>
    
    <content type="html"><![CDATA[<p>Webpack(模块打包机)是一种模块化工具，用于分析项目结构，找到JavaScript模块以及一些其他的浏览器不能直接圆形的拓展语言(Scss, TypeScript等)，并将其转换和打包为合适的格式供浏览器使用。</p>
<p>Webpack对比Grunt和Gulp：<br>Grunt/Gulp是一种优化前端的开发流程的工具；工作方式是:在一个配置文件中，指明对某些文件进行类似编译，组合，压缩等任务的具体步骤，工具之后以自动完成这些任务。</p>
<p>Webpack是一种模块化解决方案，多场景可替代Grunt/Gulp；工作方式：将项目当作一个整体，通过一个给定的主文件(如：index.js),Webpack将从这个文件开始找到项目的所有依赖文件，使用loaders处理它们，最后打包成一个(或者多个)浏览器可是别的JavaScript文件。</p>
<p>Webpack的处理速度相对于Grunt/Gulp更快更直接，能打包更多不同类型的文件。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Webpack(模块打包机)是一种模块化工具，用于分析项目结构，找到JavaScript模块以及一些其他的浏览器不能直接圆形的拓展语言(Scss, TypeScript等)，并将其转换和打包为合适的格式供浏览器使用。&lt;/p&gt;
&lt;p&gt;Webpack对比Grunt和Gulp：&lt;
    
    </summary>
    
      <category term="Webpack" scheme="http://weibo.com/categories/Webpack/"/>
    
    
  </entry>
  
  <entry>
    <title>npm模块安装问题</title>
    <link href="http://weibo.com/2018/12/04/npm%E6%A8%A1%E5%9D%97%E5%AE%89%E8%A3%85%E9%97%AE%E9%A2%98/"/>
    <id>http://weibo.com/2018/12/04/npm模块安装问题/</id>
    <published>2018-12-04T04:31:39.000Z</published>
    <updated>2018-12-04T04:38:32.243Z</updated>
    
    <content type="html"><![CDATA[<p>使用npm进行模块安装</p>
<h2 id="安装命令"><a href="#安装命令" class="headerlink" title="安装命令"></a>安装命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install formidable</div></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="问题：执行命令目录不正确-找不到package-json"><a href="#问题：执行命令目录不正确-找不到package-json" class="headerlink" title="问题：执行命令目录不正确 / 找不到package.json"></a>问题：执行命令目录不正确 / 找不到package.json</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">`-- formidable@1.0.17</div><div class="line"></div><div class="line">npm WARN enoent ENOENT: no such file or directory, open <span class="string">'C:\Users\xxxx\package.json'</span></div><div class="line">npm WARN Neil No description</div><div class="line">npm WARN Neil No repository field.</div><div class="line">npm WARN Neil No README data</div><div class="line">npm WARN Neil No license field.</div></pre></td></tr></table></figure>
<h2 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h2><p>切换<code>npm</code>目录<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">C:\Users\xxxx&gt;<span class="built_in">cd</span> C:\Program Files\nodejs\node_modules\npm</div></pre></td></tr></table></figure></p>
<h2 id="解决办法-1"><a href="#解决办法-1" class="headerlink" title="解决办法"></a>解决办法</h2><p>初始化生成<code>package.json</code>文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g</div></pre></td></tr></table></figure>
<h2 id="问题：无相关权限"><a href="#问题：无相关权限" class="headerlink" title="问题：无相关权限"></a>问题：无相关权限</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">npm ERR! Windows_NT 10.0.14393</div><div class="line">npm ERR! argv <span class="string">"C:\\Program Files\\nodejs\\node.exe"</span> <span class="string">"C:\\Program Files\\nodejs\\node_modules\\npm\\bin\\npm-cli.js"</span> <span class="string">"install"</span> <span class="string">"formidable"</span></div><div class="line">npm ERR! node v6.2.0</div><div class="line">npm ERR! npm  v3.8.9</div><div class="line">npm ERR! path C:\Program Files\nodejs\node_modules\npm\node_modules\.staging</div><div class="line">npm ERR! code EPERM</div><div class="line">npm ERR! errno -4048</div><div class="line">npm ERR! syscall mkdir</div><div class="line"></div><div class="line">npm ERR! Error: EPERM: operation not permitted, mkdir <span class="string">'C:\Program Files\nodejs\node_modules\npm\node_modules\.staging'</span></div><div class="line">npm ERR!     at Error (native)</div><div class="line">......</div></pre></td></tr></table></figure>
<h2 id="解决办法-2"><a href="#解决办法-2" class="headerlink" title="解决办法"></a>解决办法</h2><p>1、打开对应目录<br>C:\Windows\System32</p>
<p>2、以管理员身份运行<br>cmd.exe</p>
<p>3、输入 <code>npm install formidable</code> 命令，等待提示安装成功<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">C:\Program Files\nodejs\node_modules\npm&gt;npm install formidable</div><div class="line">npm@3.8.9 C:\Program Files\nodejs\node_modules\npm</div><div class="line">`-- formidable@1.0.17  extraneous</div></pre></td></tr></table></figure></p>
<h2 id="问题：重命名文件名异常"><a href="#问题：重命名文件名异常" class="headerlink" title="问题：重命名文件名异常"></a>问题：重命名文件名异常</h2><p>源码<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var form = new formidable.IncomingForm();</div><div class="line">  form.parse(request, <span class="keyword">function</span>(error, fields, files) &#123;</div><div class="line">    fs.renameSync(files.upload.path, <span class="string">"/tmp/test.png"</span>);</div></pre></td></tr></table></figure></p>
<p>异常<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">  <span class="built_in">return</span> binding.rename(pathModule._makeLong(oldPath),</div><div class="line">                 ^</div><div class="line"></div><div class="line">Error: EXDEV: cross-device link not permitted, rename <span class="string">'C:\Users\xxxx\AppData\Local\Temp\upload_e835305b073c34bf9219b7d0290fad46'</span> -&gt; <span class="string">'E:\tmp\test.png'</span></div><div class="line">    at Error (native)</div><div class="line">    at Object.fs.renameSync (fs.js:803:18)</div></pre></td></tr></table></figure></p>
<h2 id="解决办法-3"><a href="#解决办法-3" class="headerlink" title="解决办法"></a>解决办法</h2><p>指定form上传路径，默认指向系统盘<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">var form = new formidable.IncomingForm();</div><div class="line">form.uploadDir=<span class="string">'tmp'</span></div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;使用npm进行模块安装&lt;/p&gt;
&lt;h2 id=&quot;安装命令&quot;&gt;&lt;a href=&quot;#安装命令&quot; class=&quot;headerlink&quot; title=&quot;安装命令&quot;&gt;&lt;/a&gt;安装命令&lt;/h2&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;npm install formidable&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="npm" scheme="http://weibo.com/categories/npm/"/>
    
    
  </entry>
  
  <entry>
    <title>常见的浏览器User-Agent</title>
    <link href="http://weibo.com/2018/12/04/%E5%B8%B8%E8%A7%81%E7%9A%84%E6%B5%8F%E8%A7%88%E5%99%A8User-Agent/"/>
    <id>http://weibo.com/2018/12/04/常见的浏览器User-Agent/</id>
    <published>2018-12-04T02:58:01.000Z</published>
    <updated>2018-12-04T03:10:59.621Z</updated>
    
    <content type="html"><![CDATA[<p>UserAgent中文名为用户代理，是Http协议中的一部分，属于头域的组成部分，简称UA。<br>向访问网站提供你所使用的浏览器类型及版本、操作系统及版本、浏览器内核、等信息。<br>通过UA，用户所访问的网站可以显示不同的排版。<br>浏览器的UA字串的标准格式：浏览器标识(操作系统标识;加密等级标识;浏览器语言)渲染引擎标识版本信息。<br><a id="more"></a></p>
<h2 id="1、浏览器标识"><a href="#1、浏览器标识" class="headerlink" title="1、浏览器标识"></a>1、浏览器标识</h2><p>出于兼容及推广等目的，很多浏览器的标识相同，因此浏览器标识并不能说明浏览器的真实版本，真实版本信息在UA字串尾部可以找到。</p>
<h2 id="2、操作系统标识"><a href="#2、操作系统标识" class="headerlink" title="2、操作系统标识"></a>2、操作系统标识</h2><p>FreeBSD<br>X11;FreeBSD(version no.)i386<br>X11;FreeBSD(version no.)AMD64</p>
<p>Linux<br>X11;Linux ppc<br>X11;Linux ppc64<br>X11;Linux i686<br>X11;Linux x86_64</p>
<p>Mac<br>Macintosh;PPC Mac OS X<br>Macintosh;Intel Mac OS X</p>
<p>Solaris<br>X11;SunOS i86pc<br>X11;SunOs sun4u</p>
<p>Windows<br>Windows NT 6.1   对应windows7<br>Windows NT 6.0   对应windows Vista<br>Windows NT 5.2  对应windows 2003<br>Windows NT 5.1   对应windows xp<br>Windows NT 5.0   对应windows 2000<br>Windows ME<br>Windows 98</p>
<h2 id="3、加密等级标识"><a href="#3、加密等级标识" class="headerlink" title="3、加密等级标识"></a>3、加密等级标识</h2><p>N:表示无安全加密<br>I:表示弱安全加密<br>U:表示强安全加密</p>
<h2 id="4、浏览器语言"><a href="#4、浏览器语言" class="headerlink" title="4、浏览器语言"></a>4、浏览器语言</h2><p>在首选项&gt;常规&gt;语言中指定的语言</p>
<h2 id="5、渲染引擎"><a href="#5、渲染引擎" class="headerlink" title="5、渲染引擎"></a>5、渲染引擎</h2><p>显示浏览器使用的主流渲染引擎有：Gecko、WebKit、KHTML、Presto、Trident、Tasman等，格式为：渲染引擎/版本信息</p>
<h2 id="6、版本信息"><a href="#6、版本信息" class="headerlink" title="6、版本信息"></a>6、版本信息</h2><p>显示浏览器的真实版本信息，格式为：浏览器/版本信息</p>
<p>###浏览器User-Agent的详细信息</p>
<p>PC端：<br>safari5.1–MAC<br>User-Agent:Mozilla/5.0(Macintosh;U;IntelMacOSX10_6_8;en-us)AppleWebKit/534.50(KHTML,likeGecko)Version/5.1Safari/534.50</p>
<p>safari5.1–Windows<br>User-Agent:Mozilla/5.0(Windows;U;WindowsNT6.1;en-us)AppleWebKit/534.50(KHTML,likeGecko)Version/5.1Safari/534.50</p>
<p>IE9.0<br>User-Agent:Mozilla/5.0(compatible;MSIE9.0;WindowsNT6.1;Trident/5.0;</p>
<p>IE8.0<br>User-Agent:Mozilla/4.0(compatible;MSIE8.0;WindowsNT6.0;Trident/4.0)</p>
<p>IE7.0<br>User-Agent:Mozilla/4.0(compatible;MSIE7.0;WindowsNT6.0)</p>
<p>IE6.0<br>User-Agent:Mozilla/4.0(compatible;MSIE6.0;WindowsNT5.1)</p>
<p>Firefox4.0.1–MAC<br>User-Agent:Mozilla/5.0(Macintosh;IntelMacOSX10.6;rv:2.0.1)Gecko/20100101Firefox/4.0.1</p>
<p>Firefox4.0.1–Windows<br>User-Agent:Mozilla/5.0(WindowsNT6.1;rv:2.0.1)Gecko/20100101Firefox/4.0.1</p>
<p>Opera11.11–MAC<br>User-Agent:Opera/9.80(Macintosh;IntelMacOSX10.6.8;U;en)Presto/2.8.131Version/11.11</p>
<p>Opera11.11–Windows<br>User-Agent:Opera/9.80(WindowsNT6.1;U;en)Presto/2.8.131Version/11.11</p>
<p>Chrome17.0–MAC<br>User-Agent:Mozilla/5.0(Macintosh;IntelMacOSX10_7_0)AppleWebKit/535.11(KHTML,likeGecko)Chrome/17.0.963.56Safari/535.11</p>
<p>傲游（Maxthon）<br>User-Agent:Mozilla/4.0(compatible;MSIE7.0;WindowsNT5.1;Maxthon2.0)</p>
<p>腾讯TT<br>User-Agent:Mozilla/4.0(compatible;MSIE7.0;WindowsNT5.1;TencentTraveler4.0)</p>
<p>世界之窗（TheWorld）2.x<br>User-Agent:Mozilla/4.0(compatible;MSIE7.0;WindowsNT5.1)</p>
<p>世界之窗（TheWorld）3.x<br>User-Agent:Mozilla/4.0(compatible;MSIE7.0;WindowsNT5.1;TheWorld)</p>
<p>搜狗浏览器1.x<br>User-Agent:Mozilla/4.0(compatible;MSIE7.0;WindowsNT5.1;Trident/4.0;SE2.XMetaSr1.0;SE2.XMetaSr1.0;.NETCLR2.0.50727;SE2.XMetaSr1.0)</p>
<p>360浏览器<br>User-Agent:Mozilla/4.0(compatible;MSIE7.0;WindowsNT5.1;360SE)</p>
<p>Avant<br>User-Agent:Mozilla/4.0(compatible;MSIE7.0;WindowsNT5.1;AvantBrowser)</p>
<p>GreenBrowser<br>User-Agent:Mozilla/4.0(compatible;MSIE7.0;WindowsNT5.1)</p>
<p>移动设备端：</p>
<p>safariiOS4.33–iPhone<br>User-Agent:Mozilla/5.0(iPhone;U;CPUiPhoneOS4_3_3likeMacOSX;en-us)AppleWebKit/533.17.9(KHTML,likeGecko)Version/5.0.2Mobile/8J2Safari/6533.18.5</p>
<p>safariiOS4.33–iPodTouch<br>User-Agent:Mozilla/5.0(iPod;U;CPUiPhoneOS4_3_3likeMacOSX;en-us)AppleWebKit/533.17.9(KHTML,likeGecko)Version/5.0.2Mobile/8J2Safari/6533.18.5</p>
<p>safariiOS4.33–iPad<br>User-Agent:Mozilla/5.0(iPad;U;CPUOS4_3_3likeMacOSX;en-us)AppleWebKit/533.17.9(KHTML,likeGecko)Version/5.0.2Mobile/8J2Safari/6533.18.5</p>
<p>AndroidN1<br>User-Agent:Mozilla/5.0(Linux;U;Android2.3.7;en-us;NexusOneBuild/FRF91)AppleWebKit/533.1(KHTML,likeGecko)Version/4.0MobileSafari/533.1</p>
<p>AndroidQQ浏览器Forandroid<br>User-Agent:MQQBrowser/26Mozilla/5.0(Linux;U;Android2.3.7;zh-cn;MB200Build/GRJ22;CyanogenMod-7)AppleWebKit/533.1(KHTML,likeGecko)Version/4.0MobileSafari/533.1</p>
<p>AndroidOperaMobile<br>User-Agent:Opera/9.80(Android2.3.4;Linux;OperaMobi/build-1107180945;U;en-GB)Presto/2.8.149Version/11.10</p>
<p>AndroidPadMotoXoom<br>User-Agent:Mozilla/5.0(Linux;U;Android3.0;en-us;XoomBuild/HRI39)AppleWebKit/534.13(KHTML,likeGecko)Version/4.0Safari/534.13</p>
<p>BlackBerry<br>User-Agent:Mozilla/5.0(BlackBerry;U;BlackBerry9800;en)AppleWebKit/534.1+(KHTML,likeGecko)Version/6.0.0.337MobileSafari/534.1+</p>
<p>WebOSHPTouchpad<br>User-Agent:Mozilla/5.0(hp-tablet;Linux;hpwOS/3.0.0;U;en-US)AppleWebKit/534.6(KHTML,likeGecko)wOSBrowser/233.70Safari/534.6TouchPad/1.0</p>
<p>NokiaN97<br>User-Agent:Mozilla/5.0(SymbianOS/9.4;Series60/5.0NokiaN97-1/20.0.019;Profile/MIDP-2.1Configuration/CLDC-1.1)AppleWebKit/525(KHTML,likeGecko)BrowserNG/7.1.18124</p>
<p>WindowsPhoneMango<br>User-Agent:Mozilla/5.0(compatible;MSIE9.0;WindowsPhoneOS7.5;Trident/5.0;IEMobile/9.0;HTC;Titan)</p>
<p>UC无<br>User-Agent:UCWEB7.0.2.37/28/999</p>
<p>UC标准<br>User-Agent:NOKIA5700/UCWEB7.0.2.37/28/999</p>
<p>UCOpenwave<br>User-Agent:Openwave/UCWEB7.0.2.37/28/999</p>
<p>UCOpera<br>User-Agent:Mozilla/4.0(compatible;MSIE6.0;)Opera/UCWEB7.0.2.37/28/999</p>
<h2 id="浏览器识别"><a href="#浏览器识别" class="headerlink" title="浏览器识别"></a>浏览器识别</h2><h3 id="1、IE浏览器（以IE9-0为例）"><a href="#1、IE浏览器（以IE9-0为例）" class="headerlink" title="1、IE浏览器（以IE9.0为例）"></a>1、IE浏览器（以IE9.0为例）</h3><p>PC端：User-Agent:Mozilla/5.0(compatible;MSIE9.0;WindowsNT6.1;Trident/5.0;<br>移动设备：User-Agent:Mozilla/5.0(compatible;MSIE9.0;WindowsPhoneOS7.5;Trident/5.0;IEMobile/9.0;HTC;Titan)<br>由于遨游、世界之窗、360浏览器、腾讯浏览器以及搜狗浏览器、Avant、GreenBrowser均采用IE的内核，因此IE浏览器判断的标准是”MSIE“字段，MSIE字段后面的数字为版本号，但同时还需要判断不包含”Maxthon“、”Theworld“、”360SE“、”TencentTraveler“、”SE“、”Avant“等字段（GreenBrowser没有明显标识）。移动设备还需要判断IEMobile+版本号。</p>
<h3 id="2、360浏览器"><a href="#2、360浏览器" class="headerlink" title="2、360浏览器"></a>2、360浏览器</h3><p>PC端：User-Agent:Mozilla/4.0(compatible;MSIE7.0;WindowsNT5.1;Trident/4.0;InfoPath.2;.NET4.0C;.NET4.0E;.NETCLR2.0.50727;360SE)<br>移动设备：暂无<br>360浏览器的判断标准是”360SE”字段，没有版本表示。</p>
<h3 id="3、搜狗浏览器"><a href="#3、搜狗浏览器" class="headerlink" title="3、搜狗浏览器"></a>3、搜狗浏览器</h3><p>PC端：User-Agent:Mozilla/4.0(compatible;MSIE7.0;WindowsNT5.1;Trident/4.0;SE2.XMetaSr1.0;SE2.XMetaSr1.0;.NETCLR2.0.50727;SE2.XMetaSr1.0)<br>移动设备：暂无<br>搜狗浏览器的判断标准是”SE“、”MetaSr“字段，版本号为SE后面的数字。</p>
<h3 id="4、Chrome"><a href="#4、Chrome" class="headerlink" title="4、Chrome"></a>4、Chrome</h3><p>PC端：Mozilla/5.0(Macintosh;IntelMacOSX10_7_0)AppleWebKit/535.11(KHTML,likeGecko)Chrome/17.0.963.56Safari/535.11<br>移动设备：User-Agent:Mozilla/5.0(Linux;U;Android2.2.1;zh-cn;HTC_Wildfire_A3333Build/FRG83D)AppleWebKit/533.1(KHTML,likeGecko)Version/4.0MobileSafari/533.1<br>PC端chrome浏览器的判断标准是chrome字段，chrome后面的数字为版本号；移动端的chrome浏览器判断”android“、”linux“、”mobilesafari“等字段，version后面的数字为版本号。</p>
<h3 id="5、Safari"><a href="#5、Safari" class="headerlink" title="5、Safari"></a>5、Safari</h3><p>PC端：User-Agent:Mozilla/5.0(Macintosh;U;IntelMacOSX10_6_8;en-us)AppleWebKit/534.50(KHTML,likeGecko)Version/5.1Safari/534.50<br>移动设备：User-Agent:Mozilla/5.0(iPhone;U;CPUiPhoneOS4_3_3likeMacOSX;en-us)AppleWebKit/533.17.9(KHTML,likeGecko)Version/5.0.2Mobile/8J2Safari/6533.18.5<br>由于Chrome及Nokia’sSeries60browser也使用WebKit内核，因此Safari浏览器的判断必须是：包含safari字段，同时不包含chrome等信息，确定后”version/“后面的数字即为版本号。在以上条件下包含Mobile字段的即为移动设备上的Safari浏览器。</p>
<h3 id="6、腾讯浏览器"><a href="#6、腾讯浏览器" class="headerlink" title="6、腾讯浏览器"></a>6、腾讯浏览器</h3><p>PC端：User-Agent:Mozilla/4.0(compatible;MSIE7.0;WindowsNT5.1;Trident/4.0;TencentTraveler4.0;.NETCLR2.0.50727)<br>移动设备：User-Agent:MQQBrowser/26Mozilla/5.0(Linux;U;Android2.3.7;zh-cn;MB200Build/GRJ22;CyanogenMod-7)AppleWebKit/533.1(KHTML,likeGecko)Version/4.0MobileSafari/533.1<br>腾讯浏览器的判断标准是”TencentTraveler“或者”QQBrowser“，TencentTraveler或QQBrowser后面的数字为版本号。</p>
<h3 id="7、Firefox"><a href="#7、Firefox" class="headerlink" title="7、Firefox"></a>7、Firefox</h3><p>PC端：User-Agent:Mozilla/5.0(WindowsNT6.1;rv:2.0.1)Gecko/20100101Firefox/4.0.1<br>移动设备：User-Agent:Mozilla/5.0(Android;Linuxarmv7l;rv:5.0)Gecko/Firefox/5.0fennec/5.0<br>Firefox的判断标准是Firefox字段，firefox后面的数字为版本号。</p>
<h3 id="8、Theworld"><a href="#8、Theworld" class="headerlink" title="8、Theworld"></a>8、Theworld</h3><p>PC端：User-Agent:Mozilla/4.0(compatible;MSIE7.0;WindowsNT5.1;TheWorld)<br>移动设备：暂无<br>Theworld浏览器的判断标准是”Theworld“字段，没有标示版本号。<br>需要注意的是：Theworld2.x版本的User-Agent中没有”Theworld“的字段。</p>
<h3 id="9、遨游"><a href="#9、遨游" class="headerlink" title="9、遨游"></a>9、遨游</h3><p>PC端：User-Agent:Mozilla/4.0(compatible;MSIE7.0;WindowsNT5.1;Maxthon2.0)<br>移动设备：暂无<br>遨游浏览器的判断标准是”Maxthon“，Maxthon后面的数字为版本号。</p>
<h3 id="10、Opera"><a href="#10、Opera" class="headerlink" title="10、Opera"></a>10、Opera</h3><p>PC端：User-Agent:Opera/9.80(WindowsNT6.1;U;en)Presto/2.8.131Version/11.11<br>移动设备：User-Agent:Opera/9.80(Android2.3.4;Linux;Operamobi/adr-1107051709;U;zh-cn)Presto/2.8.149Version/11.10<br>opera浏览器的判断标准是opera字段，opera字段后面的数字为版本号。</p>
<h3 id="11、UC浏览器"><a href="#11、UC浏览器" class="headerlink" title="11、UC浏览器"></a>11、UC浏览器</h3><p>UCWeb有多种模式浏览方式，对应的User-Agent为：<br>UC无<br>User-Agent:UCWEB7.0.2.37/28/999</p>
<p>UC标准<br>User-Agent:NOKIA5700/UCWEB7.0.2.37/28/999</p>
<p>UCOpenwave<br>User-Agent:Openwave/UCWEB7.0.2.37/28/999</p>
<p>UCOpera<br>User-Agent:Mozilla/4.0(compatible;MSIE6.0;)Opera/UCWEB7.0.2.37/28/999</p>
<p>UC浏览器的判断标准是”UCWEB“字段，UCWEB后面的数字为版本号。</p>
<p>操作系统定向<br>操作系统定向依赖于各个浏览器在打开页面时所传输的httpheader信息中的User-Agent</p>
<h2 id="User-Agent中的不同操作系统的识别方法。"><a href="#User-Agent中的不同操作系统的识别方法。" class="headerlink" title="User-Agent中的不同操作系统的识别方法。"></a>User-Agent中的不同操作系统的识别方法。</h2><p>PC端：<br>FreeBSD<br>X11;FreeBSD(version no.)i386<br>X11;FreeBSD(version no.)AMD64</p>
<p>Linux<br>X11;Linux ppc<br>X11;Linux ppc64<br>X11;Linux i686<br>X11;Linux x86_64</p>
<p>Mac<br>Macintosh;PPC Mac OS X<br>Macintosh;Intel Mac OS X</p>
<p>Solaris<br>X11;SunOS i86pc<br>X11;SunOs sun4u</p>
<p>Windows<br>Windows NT 6.1   对应windows7<br>Windows NT 6.0   对应windows Vista<br>Windows NT 5.2  对应windows 2003<br>Windows NT 5.1   对应windows xp<br>Windows NT 5.0   对应windows 2000<br>Windows ME<br>Windows 98</p>
<p>移动设备端：<br>iOS<br>iPhone OS 10_3_3  </p>
<p>iPhone/iPod<br>OS 4_3_3</p>
<p>Android<br>Android 7.1.1    后面数字为版本号</p>
<p>WebOs<br>hpwOS/3.0.0</p>
<p>SymbianOS<br>SymbianOS/9.4</p>
<p>Windows<br>Phone OS </p>
<p>Windows Phone<br>OS 7.5</p>
<p>BlackBerry<br>BlackBerry OS</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;UserAgent中文名为用户代理，是Http协议中的一部分，属于头域的组成部分，简称UA。&lt;br&gt;向访问网站提供你所使用的浏览器类型及版本、操作系统及版本、浏览器内核、等信息。&lt;br&gt;通过UA，用户所访问的网站可以显示不同的排版。&lt;br&gt;浏览器的UA字串的标准格式：浏览器标识(操作系统标识;加密等级标识;浏览器语言)渲染引擎标识版本信息。&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="JavaScript" scheme="http://weibo.com/categories/JavaScript/"/>
    
    
  </entry>
  
  <entry>
    <title>PHP毫秒级时间戳和日期格式转换</title>
    <link href="http://weibo.com/2018/12/03/PHP%E6%AF%AB%E7%A7%92%E7%BA%A7%E6%97%B6%E9%97%B4%E6%88%B3%E5%92%8C%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F%E8%BD%AC%E6%8D%A2/"/>
    <id>http://weibo.com/2018/12/03/PHP毫秒级时间戳和日期格式转换/</id>
    <published>2018-12-03T11:44:15.000Z</published>
    <updated>2018-12-03T12:19:58.530Z</updated>
    
    <content type="html"><![CDATA[<p>在并发量搞得情况下。需要开启毫秒级运算<br>mysql  支持：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">`create_time` datetime(3) DEFAULT NULL COMMENT <span class="string">'创建时间'</span>,</div></pre></td></tr></table></figure></p>
<p>PHP 代码实现：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">    <span class="variable">$a</span> = get_msectime();</div><div class="line">    <span class="variable">$b</span> = get_microtime_format(<span class="variable">$a</span>*0.001);</div><div class="line">    <span class="variable">$c</span> = get_data_format(<span class="variable">$b</span>);</div><div class="line"></div><div class="line">    <span class="built_in">echo</span> <span class="variable">$a</span>;</div><div class="line">    <span class="built_in">echo</span> <span class="string">"&lt;pre&gt;"</span>;</div><div class="line">    <span class="built_in">echo</span> <span class="variable">$b</span>;</div><div class="line">    <span class="built_in">echo</span> <span class="string">"&lt;pre&gt;"</span>;</div><div class="line">    <span class="built_in">echo</span> <span class="variable">$c</span>;</div><div class="line"></div><div class="line">    //返回当前的毫秒时间戳</div><div class="line">    <span class="keyword">function</span> <span class="function"><span class="title">get_msectime</span></span>() &#123;</div><div class="line">        list(<span class="variable">$msec</span>, <span class="variable">$sec</span>) = explode(<span class="string">' '</span>, microtime());</div><div class="line">        <span class="variable">$msectime</span> =  (<span class="built_in">float</span>)sprintf(<span class="string">'%.0f'</span>, (floatval(<span class="variable">$msec</span>) + floatval(<span class="variable">$sec</span>)) * 1000);</div><div class="line">        <span class="built_in">return</span> <span class="variable">$msectime</span>;</div><div class="line">     &#125;</div><div class="line">     </div><div class="line">     /** </div><div class="line">      *时间戳 转   日期格式 ： 精确到毫秒，x代表毫秒</div><div class="line">      */</div><div class="line">     <span class="keyword">function</span> get_microtime_format(<span class="variable">$time</span>)</div><div class="line">     &#123;  </div><div class="line">        <span class="keyword">if</span>(strstr(<span class="variable">$time</span>,<span class="string">'.'</span>))&#123;</div><div class="line">            sprintf(<span class="string">"%01.3f"</span>,<span class="variable">$time</span>); //小数点。不足三位补0</div><div class="line">            list(<span class="variable">$usec</span>, <span class="variable">$sec</span>) = explode(<span class="string">"."</span>,<span class="variable">$time</span>);</div><div class="line">            <span class="variable">$sec</span> = str_pad(<span class="variable">$sec</span>,3,<span class="string">"0"</span>,STR_PAD_RIGHT); //不足3位。右边补0</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="variable">$usec</span> = <span class="variable">$time</span>;</div><div class="line">            <span class="variable">$sec</span> = <span class="string">"000"</span>; </div><div class="line">        &#125;</div><div class="line">        <span class="variable">$date</span> = date(<span class="string">"Y-m-d H:i:s.x"</span>,<span class="variable">$usec</span>);</div><div class="line">        <span class="built_in">return</span> str_replace(<span class="string">'x'</span>, <span class="variable">$sec</span>, <span class="variable">$date</span>);</div><div class="line">     &#125;</div><div class="line"></div><div class="line">      /** 时间日期转时间戳格式，精确到毫秒，</div><div class="line">      *     </div><div class="line">      */</div><div class="line">     <span class="keyword">function</span> get_data_format(<span class="variable">$time</span>)</div><div class="line">     &#123;</div><div class="line">        list(<span class="variable">$usec</span>, <span class="variable">$sec</span>) = explode(<span class="string">"."</span>, <span class="variable">$time</span>);</div><div class="line">        <span class="variable">$date</span> = strtotime(<span class="variable">$usec</span>);</div><div class="line">        <span class="variable">$return_data</span> = str_pad(<span class="variable">$date</span>.<span class="variable">$sec</span>,13,<span class="string">"0"</span>,STR_PAD_RIGHT); //不足13位。右边补0</div><div class="line">        <span class="built_in">return</span> <span class="variable">$return_data</span>;</div><div class="line">     &#125;</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在并发量搞得情况下。需要开启毫秒级运算&lt;br&gt;mysql  支持：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/t
    
    </summary>
    
      <category term="PHP" scheme="http://weibo.com/categories/PHP/"/>
    
    
  </entry>
  
</feed>
